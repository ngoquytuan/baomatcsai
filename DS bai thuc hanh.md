NgÃ y 1 â€“ Foundational Awareness and AI Threat Detection
Thá»±c hÃ nh (2â€“3 giá»):

- TÃ¬nh huá»‘ng: Má»™t ngÆ°á»i dÃ¹ng nháº­n Ä‘Æ°á»£c email kháº£ nghi chá»©a link láº¡.
- Pháº§n 1 â€“ Thá»§ cÃ´ng: 
  - Xem tiÃªu Ä‘á», Ä‘á»‹a chá»‰ gá»­i, ná»™i dung HTML â€“ xÃ¡c Ä‘á»‹nh dáº¥u hiá»‡u phishing báº±ng checklist.
- Pháº§n 2 â€“ CÃ³ AI há»— trá»£: 
  - Sá»­ dá»¥ng Python Ä‘á»ƒ kiá»ƒm tra email vá»›i tá»« Ä‘iá»ƒn blacklist + cÃ¡c keyword nghi váº¥n.
  - Ãp dá»¥ng TF-IDF + NaÃ¯ve Bayes Ä‘á»ƒ phÃ¡t hiá»‡n spam/phishing. NgÃ y 2 â€“ Python & Log-based Attack Detection Thá»±c hÃ nh (2â€“3 giá»):
- TÃ¬nh huá»‘ng: Má»™t mÃ¡y chá»§ ghi nháº­n log báº¥t thÆ°á»ng truy cáº­p SSH.
- Pháº§n 1 â€“ Thá»§ cÃ´ng: 
  - PhÃ¢n tÃ­ch log máº«u tá»« auth.log hoáº·c log SSH â€“ tÃ¬m pattern IP sai nhiá»u láº§n.
- Pháº§n 2 â€“ CÃ³ AI há»— trá»£: 
  - DÃ¹ng Python Ä‘á»ƒ parse log, trÃ­ch xuáº¥t Ä‘á»‹a chá»‰ IP, táº§n suáº¥t truy cáº­p.
  - Ãp dá»¥ng Isolation Forest Ä‘á»ƒ xÃ¡c Ä‘á»‹nh truy cáº­p báº¥t thÆ°á»ng. NgÃ y 3 â€“ Anomaly in System Behavior Thá»±c hÃ nh (2â€“3 giá»):
- TÃ¬nh huá»‘ng: Má»™t há»‡ thá»‘ng dá»‹ch vá»¥ ná»™i bá»™ bá»‹ cháº­m báº¥t thÆ°á»ng.
- Pháº§n 1 â€“ Thá»§ cÃ´ng: 
  - Váº½ biá»ƒu Ä‘á»“ thá»i gian táº£i CPU/máº¡ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh khoáº£ng thá»i gian báº¥t thÆ°á»ng.
- Pháº§n 2 â€“ CÃ³ AI há»— trá»£: 
  - DÃ¹ng Time Series Decomposition + Statsmodels Ä‘á»ƒ phÃ¡t hiá»‡n Ä‘á»™t biáº¿n.  
    NgÃ y 4 â€“ Email and File-based Malware Incidents Thá»±c hÃ nh (2â€“3 giá»):
- TÃ¬nh huá»‘ng: NgÆ°á»i dÃ¹ng má»Ÿ má»™t táº­p tin .exe nghi ngá» bá»‹ nhiá»…m malware.
- Pháº§n 1 â€“ Thá»§ cÃ´ng: 
  - Kiá»ƒm tra metadata, hash file, dáº¥u hiá»‡u Ä‘Ã¡ng ngá» tá»« chuá»—i trong file (dÃ¹ng strings).
- Pháº§n 2 â€“ CÃ³ AI há»— trá»£: 
  - Ãp dá»¥ng mÃ´ hÃ¬nh Decision Tree Ä‘á»ƒ phÃ¢n loáº¡i file â€œtá»‘t/xáº¥uâ€ dá»±a trÃªn Ä‘áº·c trÆ°ng Ä‘Æ¡n giáº£n (kÃ­ch thÆ°á»›c, entropy, hÃ nh vi file...). NgÃ y 5 â€“ Network Activity and User Behavior Monitoring Thá»±c hÃ nh (2â€“3 giá»):
- TÃ¬nh huá»‘ng: Má»™t ngÆ°á»i dÃ¹ng cÃ³ hoáº¡t Ä‘á»™ng báº¥t thÆ°á»ng trÃªn máº¡ng ná»™i bá»™.
- Pháº§n 1 â€“ Thá»§ cÃ´ng: 
  - Xem traffic log, thá»‘ng kÃª lÆ°á»£t truy cáº­p ra ngoÃ i giá» hÃ nh chÃ­nh, truy cáº­p báº¥t thÆ°á»ng.
- Pháº§n 2 â€“ CÃ³ AI há»— trá»£: 
  - GÃ¡n Ä‘iá»ƒm Reputation Scoring cho user dá»±a trÃªn mÃ´ hÃ¬nh chuáº©n hÃ nh vi.
  - DÃ¹ng k-means hoáº·c scoring rule Ä‘á»ƒ nhÃ³m user â€œbÃ¬nh thÆ°á»ngâ€ vÃ  â€œkhÃ¡c thÆ°á»ngâ€.

Ráº¥t chÃ­nh xÃ¡c! Báº¡n Ä‘Ã£ nÃªu má»™t Ä‘iá»ƒm **ráº¥t thá»±c táº¿** vÃ  cá»±c ká»³ quan trá»ng:  
 Trong mÃ´i trÆ°á»ng doanh nghiá»‡p hoáº·c khi xá»­ lÃ½ tÃ¬nh huá»‘ng tháº­t, **email khÃ´ng cÃ³ sáºµn dÆ°á»›i dáº¡ng CSV** â€“ mÃ  thÆ°á»ng Ä‘Æ°á»£c **xem á»Ÿ dáº¡ng** `.eml` **hoáº·c "View Source"** nhÆ° trong Outlook, Thunderbird, hay cÃ¡c webmail.

VÃ¬ váº­y, chÃºng ta nÃªn **thiáº¿t káº¿ bÃ i lab xoay quanh viá»‡c xá»­ lÃ½ email thÃ´ á»Ÿ Ä‘á»‹nh dáº¡ng** `.eml`, hoáº·c **dáº¡ng MIME/raw text**, rá»“i sau Ä‘Ã³:

- Thá»±c hiá»‡n phÃ¢n tÃ­ch **thá»§ cÃ´ng** tá»« header Ä‘áº¿n ná»™i dung
- TrÃ­ch xuáº¥t báº±ng Python Ä‘á»ƒ phÃ¢n tÃ­ch ná»™i dung, tiÃªu Ä‘á», URL nghi ngá»
- Sau Ä‘Ã³ má»›i dÃ¹ng AI Ä‘á»ƒ phÃ¢n loáº¡i

TÃ´i sáº½ viáº¿t láº¡i hoÃ n toÃ n **bÃ i thá»±c hÃ nh Day 1 theo hÆ°á»›ng Ä‘Ãºng thá»±c táº¿** nÃ y.

---

# ğŸ”¹ **DAY 1 â€“ LAB THá»°C HÃ€NH: PHÃ‚N TÃCH EMAIL** `.eml` **ÄÃNG NGá»œ VÃ€ PHÃ‚N LOáº I SPAM/PHISHING**

## **TÃ¬nh huá»‘ng mÃ´ phá»ng**

> Má»™t nhÃ¢n viÃªn bÃ¡o ráº±ng cÃ³ email láº¡ vá»›i tiÃªu Ä‘á» â€œYour account will be closedâ€ vÃ  Ä‘Æ°á»ng link dáº«n Ä‘áº¿n trang xÃ¡c nháº­n thÃ´ng tin.
>
> Báº¡n Ä‘Æ°á»£c yÃªu cáº§u:
>
> - PhÃ¢n tÃ­ch thá»§ cÃ´ng tá»« **email gá»‘c Ä‘á»‹nh dáº¡ng** `.eml`
> - XÃ¡c Ä‘á»‹nh dáº¥u hiá»‡u spam/phishing
> - Sá»­ dá»¥ng Python Ä‘á»ƒ trÃ­ch xuáº¥t thÃ´ng tin tá»« `.eml` vÃ  Ä‘Ã¡nh giÃ¡ báº±ng AI

---

## **1. Chuáº©n bá»‹ dá»¯ liá»‡u** `.eml` **(View Source / Save As Raw Email)**

### ğŸ“Œ File máº«u: `example_1.eml`

```
From: "Support Team" <support@paypal-security.com>
To: victim@example.com
Subject: [Security Alert] Your account will be closed

Dear user,

We noticed suspicious activity in your account. Please confirm your identity by clicking the link below:

http://paypal-security-check.com/verify

Failure to do so will result in permanent account closure.

Best,
PayPal Security
```

ğŸ’¡ Báº¡n cÃ³ thá»ƒ táº¡o thÃªm vÃ i file `.eml` mÃ´ phá»ng email há»£p lá»‡ Ä‘á»ƒ há»c viÃªn so sÃ¡nh.

---

## **2. Má»¥c tiÃªu**

- PhÃ¢n tÃ­ch 1 hoáº·c nhiá»u file `.eml`:
  - Header (From, To, Subject)
  - Ná»™i dung
  - URL xuáº¥t hiá»‡n trong ná»™i dung
- ÄÃ¡nh giÃ¡ thá»§ cÃ´ng (check domain, check URL)
- DÃ¹ng Python trÃ­ch xuáº¥t dá»¯ liá»‡u tá»« `.eml`
- PhÃ¢n loáº¡i tá»± Ä‘á»™ng báº±ng mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n (TF-IDF + NaÃ¯ve Bayes)

---

## **3. HÆ°á»›ng dáº«n tá»«ng bÆ°á»›c**

### ğŸ” **Pháº§n A â€“ PhÃ¢n tÃ­ch thá»§ cÃ´ng**

1. Má»Ÿ file `.eml` báº±ng Notepad hoáº·c email client â†’ View Source
2. Kiá»ƒm tra cÃ¡c thÃ nh pháº§n:
   - **From**: cÃ³ Ä‘Ãºng tÃªn miá»n cÃ´ng ty khÃ´ng?
   - **Reply-To**: cÃ³ khÃ¡c Ä‘á»‹a chá»‰ gá»­i khÃ´ng?
   - **Subject**: cÃ³ dÃ¹ng tá»« khÃ³a kháº©n cáº¥p khÃ´ng?
   - **Body**: cÃ³ link khÃ´ng? Link cÃ³ domain tháº­t khÃ´ng?
3. DÃ¡n URL vÃ o cÃ¡c cÃ´ng cá»¥ nhÆ° <https://www.virustotal.com/> Ä‘á»ƒ kiá»ƒm tra

Ghi nháº­n káº¿t quáº£: Email nÃ y cÃ³ dáº¥u hiá»‡u phishing? Táº¡i sao?

---

### ğŸ¤– **Pháº§n B â€“ PhÃ¢n tÃ­ch vÃ  phÃ¢n loáº¡i báº±ng Python**

#### BÆ°á»›c 1: Äá»c `.eml` báº±ng Python

```python
import email
from email import policy
from email.parser import BytesParser

with open("example_1.eml", "rb") as f:
    msg = BytesParser(policy=policy.default).parse(f)

print("From:", msg['From'])
print("To:", msg['To'])
print("Subject:", msg['Subject'])

body = msg.get_body(preferencelist=('plain')).get_content()
print("Body:\n", body)
```

#### BÆ°á»›c 2: TrÃ­ch xuáº¥t URL trong ná»™i dung

```python
import re
urls = re.findall(r'http[s]?://\S+', body)
print("Detected URLs:", urls)
```

#### BÆ°á»›c 3: Chuáº©n bá»‹ táº­p huáº¥n luyá»‡n mini

Táº¡o danh sÃ¡ch `.eml` gÃ¡n nhÃ£n `spam` hoáº·c `ham`, sau Ä‘Ã³ trÃ­ch ná»™i dung + gá»™p láº¡i thÃ nh dataset.

```python
import os

data = []
labels = []

# Giáº£ sá»­ báº¡n cÃ³ cÃ¡c file spam_1.eml, ham_1.eml...
for filename in os.listdir("emails"):
    if filename.endswith(".eml"):
        label = "spam" if "spam" in filename else "ham"
        with open(os.path.join("emails", filename), "rb") as f:
            msg = BytesParser(policy=policy.default).parse(f)
            body = msg.get_body(preferencelist=('plain')).get_content()
            data.append(body)
            labels.append(label)
```

#### BÆ°á»›c 4: PhÃ¢n loáº¡i báº±ng TF-IDF + NaÃ¯ve Bayes

```python
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.naive_bayes import MultinomialNB

vectorizer = TfidfVectorizer()
X = vectorizer.fit_transform(data)

model = MultinomialNB()
model.fit(X, labels)
```

#### BÆ°á»›c 5: Kiá»ƒm tra email nghi váº¥n

```python
X_new = vectorizer.transform([body])
print("Prediction:", model.predict(X_new))
```

---

## **4. Káº¿t quáº£ mong Ä‘á»£i**

| Email         | Dáº¥u hiá»‡u thá»§ cÃ´ng             | Dá»± Ä‘oÃ¡n AI |
|---------------|-------------------------------|------------|
| example_1.eml | CÃ³ link giáº£, domain láº¡ â†’ spam | spam       |
| ham_1.eml     | BÃ¬nh thÆ°á»ng                   | ham        |

Há»c viÃªn sáº½ há»c Ä‘Æ°á»£c:

- CÃ¡ch xem `.eml` thá»±c táº¿
- CÃ¡ch trÃ­ch xuáº¥t thÃ´ng tin
- So sÃ¡nh thá»§ cÃ´ng vÃ  AI
- CÃ¡ch xÃ¢y dá»±ng cÃ´ng cá»¥ há»— trá»£ thá»±c táº¿ (gáº§n giá»‘ng SIEM mini)

---

## âœ… PhÃ¹ há»£p cho:

- NhÃ¢n viÃªn IT
- KhÃ´ng cáº§n web dev
- KhÃ´ng yÃªu cáº§u CSV cÃ³ sáºµn
- Táº­p trung thá»±c táº¿ vÃ  logic nghiá»‡p vá»¥

---

Báº¡n tháº¥y phiÃªn báº£n nÃ y Ä‘Ã£ sÃ¡t thá»±c táº¿ vÃ  dá»… tiáº¿p cáº­n hÆ¡n chÆ°a? Náº¿u Ä‘Ã£ á»•n, tÃ´i sáº½ tiáº¿p tá»¥c **Day 2 â€“ PhÃ¢n tÃ­ch log SSH brute-force** cÅ©ng theo hÆ°á»›ng nhÆ° tháº¿ nÃ y.

Ráº¥t tá»‘t! DÆ°á»›i Ä‘Ã¢y lÃ  **bÃ i thá»±c hÃ nh Day 2 â€“ PhÃ¢n tÃ­ch SSH brute-force attack** theo Ä‘Ãºng hÆ°á»›ng báº¡n yÃªu cáº§u:

- **Dá»¯ liá»‡u mÃ´ phá»ng sÃ¡t thá»±c táº¿ (file log tháº­t Ä‘á»‹nh dáº¡ng syslog)**
- **CÃ³ pháº§n phÃ¢n tÃ­ch thá»§ cÃ´ng nhÆ° má»™t IT sysadmin thá»±c thá»¥**
- **CÃ³ pháº§n dÃ¹ng Python Ä‘á»ƒ há»— trá»£ tá»± Ä‘á»™ng hÃ³a vÃ  phÃ¡t hiá»‡n báº¥t thÆ°á»ng**
- **KhÃ´ng yÃªu cáº§u mÃ´ hÃ¬nh ML phá»©c táº¡p â€“ chá»‰ dÃ¹ng thuáº­t toÃ¡n Ä‘Æ¡n giáº£n, trá»±c quan**

---

# ğŸ”¹ **DAY 2 â€“ LAB THá»°C HÃ€NH: PHÃT HIá»†N Táº¤N CÃ”NG BRUTE-FORCE SSH Tá»ª LOG Há»† THá»NG**

## **TÃ¬nh huá»‘ng mÃ´ phá»ng**

> Má»™t há»‡ thá»‘ng server Linux Ä‘Æ°á»£c phÃ¡t hiá»‡n CPU tÄƒng Ä‘á»™t ngá»™t.  
>  Admin nghi ngá» cÃ³ táº¥n cÃ´ng SSH brute-force trong Ä‘Ãªm.
>
> Nhiá»‡m vá»¥ cá»§a báº¡n â€“ nhÃ¢n viÃªn IT â€“ lÃ :
>
> - PhÃ¢n tÃ­ch **log há»‡ thá»‘ng** thá»§ cÃ´ng Ä‘á»ƒ tÃ¬m IP nghi ngá»
> - Viáº¿t script Python Ä‘á»ƒ **tá»± Ä‘á»™ng phÃ¡t hiá»‡n IP Ä‘Äƒng nháº­p sai nhiá»u láº§n**
> - XÃ¡c Ä‘á»‹nh hÃ nh vi brute-force vÃ  cáº£nh bÃ¡o

---

## **1. Dá»¯ liá»‡u mÃ´ phá»ng**

Táº¡o file `auth.log` (giá»‘ng log tháº­t cá»§a `/var/log/auth.log` trÃªn Ubuntu):

```
Jul 25 03:21:17 myserver sshd[23510]: Failed password for invalid user admin from 192.168.1.10 port 54322 ssh2
Jul 25 03:21:18 myserver sshd[23510]: Failed password for invalid user admin from 192.168.1.10 port 54322 ssh2
Jul 25 03:21:20 myserver sshd[23510]: Failed password for invalid user root from 192.168.1.10 port 54322 ssh2
Jul 25 03:25:15 myserver sshd[24515]: Failed password for invalid user test from 192.168.1.10 port 54345 ssh2
Jul 25 04:05:02 myserver sshd[25480]: Accepted password for john from 192.168.1.22 port 54213 ssh2
Jul 25 04:12:55 myserver sshd[26800]: Failed password for root from 192.168.1.15 port 51234 ssh2
Jul 25 04:12:56 myserver sshd[26800]: Failed password for root from 192.168.1.15 port 51234 ssh2
Jul 25 04:12:57 myserver sshd[26800]: Failed password for root from 192.168.1.15 port 51234 ssh2
```

---

## **2. Má»¥c tiÃªu**

- PhÃ¢n tÃ­ch log giá»‘ng thá»±c táº¿
- PhÃ¡t hiá»‡n IP cá»‘ gáº¯ng Ä‘Äƒng nháº­p quÃ¡ nhiá»u láº§n trong thá»i gian ngáº¯n
- Tá»± Ä‘á»™ng thá»‘ng kÃª vÃ  cáº£nh bÃ¡o báº±ng Python
- (Tuá»³ chá»n) Váº½ biá»ƒu Ä‘á»“ lÆ°á»£ng táº¥n cÃ´ng theo thá»i gian/IP

---

## **3. HÆ°á»›ng dáº«n Lab**

### ğŸ” **Pháº§n A â€“ PhÃ¢n tÃ­ch thá»§ cÃ´ng**

**BÆ°á»›c 1:** Má»Ÿ file `auth.log`  
 **BÆ°á»›c 2:** TÃ¬m cÃ¡c dÃ²ng `Failed password`  
 **BÆ°á»›c 3:** Ghi láº¡i IP láº·p láº¡i nhiá»u láº§n (VD: `192.168.1.10`, `192.168.1.15`)  
 **BÆ°á»›c 4:** ÄÆ°a ra káº¿t luáº­n: IP nÃ o Ä‘Ã¡ng nghi? CÃ³ pháº£i brute-force?

Gá»£i Ã½ Ä‘Ã¡nh giÃ¡:

- 3 láº§n login sai liÃªn tiáº¿p tá»« cÃ¹ng IP
- IP cá»‘ login vá»›i nhiá»u user (admin, root, test...)

âœ… Viá»‡c nÃ y giÃºp há»c viÃªn hÃ¬nh dung cÃ¡ch cÃ¡c team SOC phÃ¢n tÃ­ch log thÃ´.

---

### ğŸ¤– **Pháº§n B â€“ DÃ¹ng Python Ä‘á»ƒ tá»± Ä‘á»™ng phÃ¡t hiá»‡n**

#### BÆ°á»›c 1: Äá»c file log

```python
with open("auth.log", "r") as f:
    lines = f.readlines()
```

#### BÆ°á»›c 2: TrÃ­ch IP tá»« cÃ¡c dÃ²ng `Failed password`

```python
import re
from collections import defaultdict

ip_count = defaultdict(int)

for line in lines:
    if "Failed password" in line:
        ip_match = re.search(r'from (\d+\.\d+\.\d+\.\d+)', line)
        if ip_match:
            ip = ip_match.group(1)
            ip_count[ip] += 1

for ip, count in ip_count.items():
    print(f"{ip} => {count} failed attempts")
```

#### BÆ°á»›c 3: Cáº£nh bÃ¡o brute-force

```python
for ip, count in ip_count.items():
    if count >= 3:
        print(f"âš ï¸ WARNING: Possible brute-force attack from {ip}")
```

---

### ğŸ“Š (Tuá»³ chá»n nÃ¢ng cao): Váº½ biá»ƒu Ä‘á»“ báº±ng `matplotlib`

```python
import matplotlib.pyplot as plt

ips = list(ip_count.keys())
counts = list(ip_count.values())

plt.barh(ips, counts)
plt.xlabel("Failed login attempts")
plt.ylabel("IP Address")
plt.title("SSH Brute-force Attempts")
plt.show()
```

---

## **4. Káº¿t quáº£ mong Ä‘á»£i**

| IP           | LÆ°á»£t login sai | Cáº£nh bÃ¡o |
|--------------|----------------|----------|
| 192.168.1.10 | 4              | CÃ³       |
| 192.168.1.15 | 3              | CÃ³       |
| 192.168.1.22 | 0              | KhÃ´ng    |

---

## âœ… CÃ´ng cá»¥ cáº§n thiáº¿t

- Python 3.8+
- File `auth.log` thá»±c táº¿ hoáº·c mÃ´ phá»ng
- ThÆ° viá»‡n: `re`, `collections`, `matplotlib` (náº¿u váº½ biá»ƒu Ä‘á»“)

---

## âœ… DÃ nh cho ai?

- NhÃ¢n viÃªn IT, sysadmin, váº­n hÃ nh há»‡ thá»‘ng
- KhÃ´ng yÃªu cáº§u ML, khÃ´ng cáº§n CSV
- MÃ´ phá»ng chÃ­nh xÃ¡c cÃ´ng viá»‡c giÃ¡m sÃ¡t log báº£o máº­t

---

## ğŸ“Œ Gá»£i Ã½ má»Ÿ rá»™ng

- Tá»± Ä‘á»™ng táº¡o blacklist hoáº·c cháº·n IP (xuáº¥t file `block.txt`)
- Kiá»ƒm tra náº¿u nhiá»u IP táº¥n cÃ´ng cÃ¹ng lÃºc tá»« cÃ¹ng subnet
- Cháº¡y Ä‘á»‹nh ká»³ qua cron Ä‘á»ƒ gá»­i cáº£nh bÃ¡o mail (gá»£i Ã½ nÃ¢ng cao)

---

Náº¿u báº¡n Ä‘á»“ng Ã½ vá»›i format nÃ y, tÃ´i sáº½ tiáº¿p tá»¥c viáº¿t **Day 3 â€“ PhÃ¡t hiá»‡n báº¥t thÆ°á»ng theo thá»i gian (system load, traffic...)** theo hÆ°á»›ng tÆ°Æ¡ng tá»±. CÃ³ cáº§n tÃ´i trÃ­ch riÃªng Notebook máº«u `.ipynb` sau cÃ¹ng cho tá»«ng lab khÃ´ng?

Tuyá»‡t vá»i! DÆ°á»›i Ä‘Ã¢y lÃ  **bÃ i thá»±c hÃ nh Day 3 â€“ PhÃ¡t hiá»‡n báº¥t thÆ°á»ng theo thá»i gian**, Ä‘Æ°á»£c xÃ¢y dá»±ng theo Ä‘Ãºng hÆ°á»›ng:

- MÃ´ phá»ng **tÃ¬nh huá»‘ng thá»±c táº¿ mÃ  IT gáº·p pháº£i**
- CÃ³ pháº§n xá»­ lÃ½ **thá»§ cÃ´ng dá»±a trÃªn quan sÃ¡t vÃ  logic**
- CÃ³ pháº§n há»— trá»£ báº±ng Python (dá»… hiá»ƒu, trá»±c quan, khÃ´ng ML phá»©c táº¡p)
- Sá»­ dá»¥ng dá»¯ liá»‡u **dáº¡ng log thá»i gian thá»±c hoáº·c Ä‘o chá»‰ sá»‘ há»‡ thá»‘ng**

---

# ğŸ”¹ **DAY 3 â€“ LAB THá»°C HÃ€NH: PHÃT HIá»†N Báº¤T THÆ¯á»œNG TRONG Há»† THá»NG Dá»°A TRÃŠN TIME SERIES**

## **TÃ¬nh huá»‘ng mÃ´ phá»ng**

> Server cá»§a cÃ´ng ty bá»‹ cháº­m báº¥t thÆ°á»ng tá»« 02:00 Ä‘áº¿n 04:00 sÃ¡ng.  
>  Báº¡n Ä‘Æ°á»£c yÃªu cáº§u phÃ¢n tÃ­ch log Ä‘o hiá»‡u suáº¥t há»‡ thá»‘ng (CPU, memory, network)  
>  Ä‘á»ƒ xÃ¡c Ä‘á»‹nh khoáº£ng thá»i gian báº¥t thÆ°á»ng vÃ  nguyÃªn nhÃ¢n tiá»m áº©n.

---

## **1. Dá»¯ liá»‡u mÃ´ phá»ng**

Táº¡o file CSV `system_metrics.csv` (1 phÃºt ghi 1 láº§n, giá»‘ng nhÆ° tool monitoring thá»±c táº¿ nhÆ° `collectl`, `top`, `prometheus`...)

```csv
timestamp,cpu_usage,mem_usage,network_in,network_out
2024-07-25 01:55,22,40,100,90
2024-07-25 01:56,24,42,105,92
2024-07-25 01:57,28,43,110,95
2024-07-25 01:58,85,80,900,890
2024-07-25 01:59,88,85,950,920
2024-07-25 02:00,92,90,980,930
2024-07-25 02:01,91,91,970,940
2024-07-25 02:02,93,89,960,950
2024-07-25 02:10,28,45,120,100
2024-07-25 02:20,25,44,115,98
```

ğŸ“Œ CÃ¡c cá»™t:

- `timestamp`: thá»i gian Ä‘o (phÃºt)
- `cpu_usage`, `mem_usage`: tÃ­nh theo %
- `network_in`, `network_out`: KB/s

---

## **2. Má»¥c tiÃªu bÃ i há»c**

- PhÃ¡t hiá»‡n thá»§ cÃ´ng thá»i Ä‘iá»ƒm "há»‡ thá»‘ng báº¥t thÆ°á»ng"
- Váº½ biá»ƒu Ä‘á»“ Ä‘á»ƒ trá»±c quan hÃ³a dá»¯ liá»‡u
- DÃ¹ng cÃ´ng cá»¥ Python Ä‘á»ƒ Ä‘Ã¡nh dáº¥u cÃ¡c Ä‘iá»ƒm "anomaly" Ä‘Æ¡n giáº£n báº±ng ngÆ°á»¡ng hoáº·c phÃ¢n phá»‘i

---

## **3. HÆ°á»›ng dáº«n thá»±c hÃ nh**

### ğŸ” **Pháº§n A â€“ Thá»§ cÃ´ng**

**BÆ°á»›c 1:** Má»Ÿ file CSV báº±ng Excel hoáº·c Jupyter  
 **BÆ°á»›c 2:** ÄÃ¡nh giÃ¡:

- Thá»i gian nÃ o CPU > 80%
- Thá»i gian nÃ o network tÄƒng Ä‘á»™t ngá»™t

**BÆ°á»›c 3:** ÄÃ¡nh dáº¥u vÃ o báº£ng thá»i Ä‘iá»ƒm nghi ngá», láº­p biá»ƒu

â†’ Gá»£i Ã½ káº¿t luáº­n: â€œTá»« 01:58 Ä‘áº¿n 02:02 cÃ³ Ä‘á»™t biáº¿n cáº£ CPU vÃ  traffic máº¡ng. CÃ³ thá»ƒ lÃ  brute-force hoáº·c malware táº£i dá»¯ liá»‡u.â€

---

### ğŸ¤– **Pháº§n B â€“ DÃ¹ng Python há»— trá»£**

#### BÆ°á»›c 1: Load dá»¯ liá»‡u

```python
import pandas as pd

df = pd.read_csv("system_metrics.csv", parse_dates=["timestamp"])
df.set_index("timestamp", inplace=True)
print(df.head())
```

#### BÆ°á»›c 2: Váº½ biá»ƒu Ä‘á»“ CPU vÃ  network

```python
import matplotlib.pyplot as plt

df["cpu_usage"].plot(label="CPU (%)", figsize=(12, 4))
df["network_in"].plot(label="Network In", secondary_y=True)
plt.title("System Load Over Time")
plt.legend()
plt.grid()
plt.show()
```

#### BÆ°á»›c 3: ÄÃ¡nh dáº¥u báº¥t thÆ°á»ng (threshold-based)

```python
anomalies = df[(df["cpu_usage"] > 80) | (df["network_in"] > 800)]
print("Suspicious records:\n", anomalies)
```

#### (Tuá»³ chá»n) BÆ°á»›c 4: Váº½ Ä‘iá»ƒm báº¥t thÆ°á»ng

```python
plt.figure(figsize=(12, 4))
plt.plot(df.index, df["cpu_usage"], label="CPU Usage")
plt.scatter(anomalies.index, anomalies["cpu_usage"], color="red", label="Anomaly")
plt.title("Detected CPU Anomalies")
plt.legend()
plt.show()
```

---

## **4. Káº¿t quáº£ mong Ä‘á»£i**

| Thá»i Ä‘iá»ƒm     | CPU (%) | Network In | Nháº­n xÃ©t                |
|---------------|---------|------------|-------------------------|
| 01:58 â€“ 02:02 | 85â€“93   | 900â€“980    | Äá»™t biáº¿n cao â†’ nghi váº¥n |
| 02:10 trá»Ÿ Ä‘i  | <30     | \~100       | BÃ¬nh thÆ°á»ng             |

Há»c viÃªn rÃºt ra:

- CÃ¡ch phÃ¢n tÃ­ch log hiá»‡u suáº¥t
- CÃ¡ch xÃ¡c Ä‘á»‹nh khoáº£ng thá»i gian "báº¥t thÆ°á»ng" khÃ´ng cáº§n ML
- CÃ³ thá»ƒ Ã¡p dá»¥ng cho monitoring (Zabbix, Grafana, Prometheus...)

---

## âœ… CÃ´ng cá»¥ yÃªu cáº§u

- Python 3.8+
- File `system_metrics.csv`
- ThÆ° viá»‡n: `pandas`, `matplotlib`

---

## âœ… DÃ nh cho ai?

- NhÃ¢n viÃªn IT, sysadmin
- KhÃ´ng yÃªu cáº§u ML
- Ráº¥t sÃ¡t cÃ´ng viá»‡c phÃ¢n tÃ­ch log system thá»±c táº¿

---

## ğŸ“Œ Gá»£i Ã½ nÃ¢ng cao

- Tá»± Ä‘á»™ng cáº£nh bÃ¡o náº¿u CPU > 85% liÃªn tá»¥c 3 láº§n liÃªn tiáº¿p
- Ghi log ra file hoáº·c gá»­i cáº£nh bÃ¡o (qua Telegram, email â€“ bonus)

---

Báº¡n tháº¥y hÆ°á»›ng tiáº¿p cáº­n bÃ i nÃ y Ä‘Ã£ Ä‘á»§ trá»±c quan vÃ  sÃ¡t thá»±c táº¿ chÆ°a?  
 Náº¿u á»•n, tÃ´i sáº½ tiáº¿p tá»¥c vá»›i **Day 4 â€“ Email file malware phÃ¢n tÃ­ch cÆ¡ báº£n vá»›i Python + rule logic** nhÃ©.

Ráº¥t tá»‘t! DÆ°á»›i Ä‘Ã¢y lÃ  **bÃ i thá»±c hÃ nh Day 4 â€“ PhÃ¢n tÃ­ch táº­p tin nghi ngá» chá»©a mÃ£ Ä‘á»™c** Ä‘Æ°á»£c thiáº¿t káº¿ theo hÆ°á»›ng sÃ¡t thá»±c táº¿:

- KhÃ´ng yÃªu cáº§u kiáº¿n thá»©c reverse engineering hay malware analyst chuyÃªn sÃ¢u
- Giáº£ láº­p tÃ¬nh huá»‘ng thá»±c táº¿ nhÆ° IT nháº­n file `.exe`, `.docm`, `.js` tá»« email ngÆ°á»i dÃ¹ng
- CÃ³ pháº§n **thá»§ cÃ´ng (check metadata, strings)**
- CÃ³ pháº§n dÃ¹ng Python Ã¡p dá»¥ng **logic luáº­t (rule-based)** vÃ  mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n (Decision Tree)

---

# ğŸ”¹ **DAY 4 â€“ LAB THá»°C HÃ€NH: PHÃ‚N TÃCH Táº¬P TIN NGHI MÃƒ Äá»˜C (FILE ATTACHMENT)**

## **TÃ¬nh huá»‘ng mÃ´ phá»ng**

> NgÆ°á»i dÃ¹ng bÃ¡o ráº±ng há» nháº­n Ä‘Æ°á»£c file "invoice_update.exe" tá»« Ä‘á»‘i tÃ¡c cÅ©.  
>  Sau khi má»Ÿ, mÃ¡y cháº­m báº¥t thÆ°á»ng.
>
> Báº¡n (nhÃ¢n viÃªn IT) cáº§n:
>
> - PhÃ¢n tÃ­ch thá»§ cÃ´ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ tÃ­nh Ä‘Ã¡ng ngá»
> - DÃ¹ng script Python Ä‘á»ƒ kiá»ƒm tra batch file/táº­p tin theo luáº­t nháº­n diá»‡n Ä‘Æ¡n giáº£n
> - Ãp dá»¥ng AI Ä‘Æ¡n giáº£n Ä‘á»ƒ há»— trá»£ phÃ¢n loáº¡i náº¿u cáº§n

---

## **1. Chuáº©n bá»‹ dá»¯ liá»‡u**

Táº¡o thÆ° má»¥c `samples/` chá»©a cÃ¡c file sau:

- `invoice_update.exe`: giáº£ láº­p file `.exe` kháº£ nghi (cÃ³ thá»ƒ lÃ  file text Ä‘á»•i Ä‘uÃ´i `.exe`)
- `install_tool.exe`: file bÃ¬nh thÆ°á»ng
- `doc_viewer.docm`: táº­p tin Word cÃ³ macro
- `malicious_script.js`: file script JS Ä‘Æ¡n giáº£n cÃ³ `eval()`, `window.download`
- `clean_readme.txt`: file an toÃ n

ğŸ’¡ File `.exe` tháº­t khÃ´ng cáº§n cháº¡y â€“ chá»‰ dÃ¹ng Ä‘á»ƒ **trÃ­ch thÃ´ng tin, hash, strings**, khÃ´ng phÃ¢n tÃ­ch Ä‘á»™ng.

---

## **2. Má»¥c tiÃªu bÃ i há»c**

- PhÃ¢n tÃ­ch táº­p tin qua metadata (tÃªn, kÃ­ch thÆ°á»›c, hash, loáº¡i file)
- ÄÃ¡nh giÃ¡ luáº­t nháº­n diá»‡n nguy cÆ¡:
  - `.exe`, `.js`, `.docm` lÃ  file nguy hiá»ƒm
  - CÃ³ hÃ m nhÆ° `eval`, `exec`, `CreateObject`, `ShellExecute`
- Ãp dá»¥ng Python Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a kiá»ƒm tra vÃ  phÃ¢n loáº¡i
- CÃ³ thá»ƒ sá»­ dá»¥ng Decision Tree náº¿u muá»‘n nÃ¢ng cáº¥p

---

## **3. HÆ°á»›ng dáº«n lab**

### ğŸ” **Pháº§n A â€“ PhÃ¢n tÃ­ch thá»§ cÃ´ng**

**BÆ°á»›c 1:** Xem thÃ´ng tin file

```bash
file invoice_update.exe
ls -lh samples/
```

**BÆ°á»›c 2:** TÃ­nh hash Ä‘á»ƒ so sÃ¡nh/memo hÃ³a

```bash
sha256sum invoice_update.exe
```

**BÆ°á»›c 3:** Xem ná»™i dung chuá»—i (Windows dÃ¹ng Notepad, Linux dÃ¹ng `strings`)

```bash
strings invoice_update.exe | less
```

Ghi nháº­n:

- TÃªn file láº¡?
- CÃ³ tá»« khÃ³a láº¡ nhÆ° `"eval"`, `"powershell"`, `"http"`?
- Äá»‹nh dáº¡ng file cÃ³ trÃ¹ng khá»›p khÃ´ng?

---

### ğŸ¤– **Pháº§n B â€“ DÃ¹ng Python kiá»ƒm tra rule-based**

#### BÆ°á»›c 1: QuÃ©t file trong thÆ° má»¥c `samples/`

```python
import os
import hashlib

def get_file_hash(path):
    with open(path, "rb") as f:
        return hashlib.sha256(f.read()).hexdigest()

files = os.listdir("samples/")
for f in files:
    full_path = os.path.join("samples", f)
    print(f"File: {f}")
    print(f"  Size: {os.path.getsize(full_path)} bytes")
    print(f"  Hash: {get_file_hash(full_path)}")
```

#### BÆ°á»›c 2: Rule check theo Ä‘uÃ´i file & strings nguy hiá»ƒm

```python
dangerous_ext = ['.exe', '.js', '.vbs', '.docm']
suspicious_keywords = ['eval', 'CreateObject', 'powershell', 'ShellExecute', 'http']

def is_suspicious_file(path):
    ext = os.path.splitext(path)[1]
    score = 0

    if ext in dangerous_ext:
        score += 1

    with open(path, "rb") as f:
        content = f.read().decode(errors="ignore")
        for keyword in suspicious_keywords:
            if keyword in content:
                score += 1

    return score >= 2

print("\nSuspicious Files:")
for f in files:
    full_path = os.path.join("samples", f)
    if is_suspicious_file(full_path):
        print(f"âš ï¸ {f} is potentially malicious")
```

---

### ğŸ“Š (Tuá»³ chá»n nÃ¢ng cao): Sá»­ dá»¥ng Decision Tree

Náº¿u cÃ³ táº­p feature Ä‘Æ¡n giáº£n (size, count keyword, extension...), cÃ³ thá»ƒ dÃ¹ng mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n:

```python
from sklearn.tree import DecisionTreeClassifier

# Example data format
X = [[12000, 3], [400, 0], [2000, 1], [5600, 2]]  # [size, keyword_count]
y = ["malicious", "benign", "benign", "malicious"]

model = DecisionTreeClassifier()
model.fit(X, y)
```

---

## **4. Káº¿t quáº£ mong Ä‘á»£i**

| File name          | KÃ­ch thÆ°á»›c | Keyword | ÄuÃ´i file | ÄÃ¡nh giÃ¡  |
|--------------------|------------|---------|-----------|-----------|
| invoice_update.exe | 12KB       | 3       | .exe      | Nguy hiá»ƒm |
| doc_viewer.docm    | 20KB       | 2       | .docm     | Nguy hiá»ƒm |
| clean_readme.txt   | 1KB        | 0       | .txt      | An toÃ n   |

---

## âœ… CÃ´ng cá»¥ yÃªu cáº§u

- Python 3.8+
- File máº«u `.exe`, `.docm`, `.js`
- ThÆ° viá»‡n: `os`, `hashlib`, `sklearn` (tuá»³ chá»n)
- KhÃ´ng cáº§n cÃ i sandbox, khÃ´ng cháº¡y file!

---

## âœ… DÃ nh cho ai?

- IT Helpdesk, Sysadmin, SOC analyst
- KhÃ´ng cáº§n láº­p trÃ¬nh sÃ¢u
- TÄƒng ká»¹ nÄƒng kiá»ƒm tra file Ä‘Ã­nh kÃ¨m email â€“ tÃ¬nh huá»‘ng cá»±c ká»³ phá»• biáº¿n

---

## ğŸ“Œ Gá»£i Ã½ má»Ÿ rá»™ng

- Tá»± Ä‘á»™ng ghi log káº¿t quáº£ kiá»ƒm tra vÃ o CSV
- So sÃ¡nh hash vá»›i VirusTotal (nÃ¢ng cao)
- TÃ­ch há»£p chá»©c nÄƒng bÃ¡o Ä‘á»™ng náº¿u vÆ°á»£t threshold

---

Náº¿u báº¡n tháº¥y á»•n, tÃ´i sáº½ tiáº¿p tá»¥c vá»›i **Day 5 â€“ GiÃ¡m sÃ¡t hÃ nh vi ngÆ°á»i dÃ¹ng vÃ  phÃ¡t hiá»‡n botnet nháº¹ nhÃ ng** theo format tÆ°Æ¡ng tá»±. Báº¡n cÃ³ cáº§n tÃ´i tá»•ng há»£p sau nÃ y thÃ nh má»™t sá»• tay hÆ°á»›ng dáº«n hoáº·c tÃ i liá»‡u giáº£ng dáº¡y dáº¡ng `.docx/.pdf` khÃ´ng?

Tuyá»‡t vá»i! DÆ°á»›i Ä‘Ã¢y lÃ  **bÃ i thá»±c hÃ nh Day 5 â€“ GiÃ¡m sÃ¡t hÃ nh vi ngÆ°á»i dÃ¹ng & phÃ¡t hiá»‡n botnet nháº¹ nhÃ ng**, thiáº¿t káº¿ dÃ nh cho **nhÃ¢n viÃªn IT khÃ´ng chuyÃªn pentest hoáº·c AI nÃ¢ng cao**, vá»›i:

- **Dá»¯ liá»‡u mÃ´ phá»ng thá»±c táº¿ (user logs, traffic logs)**
- **Thá»±c hÃ nh thá»§ cÃ´ng (logic quan sÃ¡t báº¥t thÆ°á»ng)**
- **Tá»± Ä‘á»™ng hÃ³a vá»›i Python báº±ng rule vÃ  phÃ¢n nhÃ³m Ä‘Æ¡n giáº£n (clustering hoáº·c scoring)**
- **KhÃ´ng dÃ¹ng mÃ´ hÃ¬nh AI phá»©c táº¡p**, chá»‰ dÃ¹ng ká»¹ thuáº­t trá»±c quan & logic há»£p lÃ½

---

# ğŸ”¹ **DAY 5 â€“ LAB THá»°C HÃ€NH: GIÃM SÃT HÃ€NH VI NGÆ¯á»œI DÃ™NG & PHÃT HIá»†N BOTNET ÄÆ N GIáº¢N**

---

## **TÃ¬nh huá»‘ng mÃ´ phá»ng**

> Server ghi nháº­n má»™t sá»‘ hÃ nh vi ká»³ láº¡ tá»« ngÆ°á»i dÃ¹ng vÃ  IP truy cáº­p:
>
> - Má»™t tÃ i khoáº£n Ä‘Äƒng nháº­p lÃºc 2AM trong 3 ngÃ y liÃªn tiáº¿p
> - Má»™t nhÃ³m IP gá»­i request giá»‘ng nhau láº·p láº¡i nhiá»u láº§n
>
> Báº¡n (nhÃ¢n viÃªn IT) cáº§n:
>
> - PhÃ¢n tÃ­ch hÃ nh vi user Ä‘á»ƒ xem cÃ³ dáº¥u hiá»‡u xÃ¢m nháº­p khÃ´ng
> - PhÃ¢n tÃ­ch IP truy cáº­p cÃ³ pháº£i botnet khÃ´ng
> - DÃ¹ng Python Ä‘á»ƒ thá»‘ng kÃª vÃ  nhÃ³m hÃ nh vi báº¥t thÆ°á»ng

---

## **1. Dá»¯ liá»‡u mÃ´ phá»ng**

### ğŸ“„ `user_activity_log.csv`

```csv
timestamp,user_id,action
2024-07-25 02:01:12,user1,login
2024-07-25 09:02:05,user2,login
2024-07-25 14:15:30,user2,upload
2024-07-26 02:01:10,user1,login
2024-07-27 02:00:55,user1,login
2024-07-27 10:15:10,user2,logout
```

### ğŸ“„ `network_log.csv`

```csv
timestamp,src_ip,dst_ip,bytes
2024-07-25 01:55:00,192.168.1.10,10.0.0.1,500
2024-07-25 01:55:01,192.168.1.10,10.0.0.1,500
2024-07-25 01:55:02,192.168.1.10,10.0.0.1,500
2024-07-25 01:56:00,192.168.1.11,10.0.0.1,500
2024-07-25 01:56:01,192.168.1.11,10.0.0.1,500
2024-07-25 02:10:00,192.168.1.22,10.0.0.1,50
```

---

## **2. Má»¥c tiÃªu**

- PhÃ¢n tÃ­ch user login Ä‘á»ƒ phÃ¡t hiá»‡n hÃ nh vi báº¥t thÆ°á»ng (Ä‘Äƒng nháº­p ngoÃ i giá» hÃ nh chÃ­nh)
- Nháº­n diá»‡n IP cÃ³ hÃ nh vi "bot-like" (gá»­i nhiá»u request giá»‘ng nhau)
- Tá»± Ä‘á»™ng thá»‘ng kÃª vÃ  nhÃ³m báº¥t thÆ°á»ng báº±ng Python

---

## **3. HÆ°á»›ng dáº«n thá»±c hÃ nh**

### ğŸ” **Pháº§n A â€“ Thá»§ cÃ´ng**

#### A1. PhÃ¢n tÃ­ch user hoáº¡t Ä‘á»™ng Ä‘Ãªm khuya

**BÆ°á»›c 1:** Äá»c log `user_activity_log.csv`  
 **BÆ°á»›c 2:** Lá»c cÃ¡c dÃ²ng `login`  
 **BÆ°á»›c 3:** XÃ¡c Ä‘á»‹nh thá»i Ä‘iá»ƒm truy cáº­p báº¥t thÆ°á»ng (vÃ­ dá»¥: 0hâ€“5h sÃ¡ng)

#### A2. Nháº­n diá»‡n IP Ä‘Ã¡ng ngá»

**BÆ°á»›c 1:** NhÃ³m theo IP trong `network_log.csv`  
 **BÆ°á»›c 2:** Äáº¿m sá»‘ láº§n gá»­i cÃ¹ng kÃ­ch thÆ°á»›c dá»¯ liá»‡u (gá»£i Ã½ botnet C2 beacon)

---

### ğŸ¤– **Pháº§n B â€“ Tá»± Ä‘á»™ng hÃ³a báº±ng Python**

#### B1. GiÃ¡m sÃ¡t login ngoÃ i giá»

```python
import pandas as pd

df = pd.read_csv("user_activity_log.csv", parse_dates=["timestamp"])
df_login = df[df["action"] == "login"]
df_login["hour"] = df_login["timestamp"].dt.hour

suspicious_logins = df_login[df_login["hour"] < 6]
print("âš ï¸ Suspicious logins:\n", suspicious_logins)
```

#### B2. Thá»‘ng kÃª IP gá»­i request giá»‘ng nhau

```python
net = pd.read_csv("network_log.csv", parse_dates=["timestamp"])
net["key"] = net["src_ip"] + "_" + net["bytes"].astype(str)

suspicious_ip = net.groupby("key").size().reset_index(name="count")
suspicious_ip = suspicious_ip[suspicious_ip["count"] > 2]

print("âš ï¸ Repetitive traffic (bot-like):\n", suspicious_ip)
```

#### (Tuá»³ chá»n nÃ¢ng cao): GÃ¡n **score** cho user & IP

```python
# User scoring
df_user_score = df_login.groupby("user_id")["hour"].apply(lambda x: (x < 6).sum())
print("User Risk Score:\n", df_user_score)

# IP scoring
ip_score = net.groupby("src_ip").size()
print("IP Risk Score:\n", ip_score[ip_score > 3])
```

---

## **4. Káº¿t quáº£ mong Ä‘á»£i**

| User  | Login ban Ä‘Ãªm | Risk Score | Ghi chÃº      |
|-------|---------------|------------|--------------|
| user1 | 3             | Cao        | Cáº§n kiá»ƒm tra |
| user2 | 0             | Tháº¥p       | BÃ¬nh thÆ°á»ng  |

| IP           | Sá»‘ request giá»‘ng nhau | Ghi chÃº           |
|--------------|-----------------------|-------------------|
| 192.168.1.10 | 3                     | HÃ nh vi giá»‘ng bot |
| 192.168.1.22 | 1                     | BÃ¬nh thÆ°á»ng       |

---

## âœ… CÃ´ng cá»¥ yÃªu cáº§u

- Python 3.8+
- ThÆ° viá»‡n: `pandas`, `matplotlib` (tuá»³ chá»n náº¿u muá»‘n váº½ biá»ƒu Ä‘á»“)
- Dá»¯ liá»‡u `.csv` mÃ´ phá»ng tá»« log há»‡ thá»‘ng hoáº·c SIEM

---

## âœ… DÃ nh cho ai?

- NhÃ¢n viÃªn IT váº­n hÃ nh, báº£o máº­t cáº¥p cÆ¡ báº£n
- KhÃ´ng yÃªu cáº§u AI nÃ¢ng cao hay mÃ´ hÃ¬nh mÃ¡y há»c
- Thá»±c hÃ nh Ä‘Ãºng logic phÃ¢n tÃ­ch báº¥t thÆ°á»ng tá»« log

---

## ğŸ“Œ Gá»£i Ã½ nÃ¢ng cao

- Cáº£nh bÃ¡o náº¿u user Ä‘Äƒng nháº­p tá»« IP má»›i chÆ°a tá»«ng tháº¥y
- Xuáº¥t bÃ¡o cÃ¡o HTML hÃ ng ngÃ y gá»­i SOC
- TÃ­ch há»£p script nÃ y vÃ o há»‡ thá»‘ng SIEM ná»™i bá»™ mini

---

Báº¡n cÃ³ muá»‘n tÃ´i **tá»•ng há»£p táº¥t cáº£ Day 1 â†’ 5 thÃ nh má»™t file PDF/Sá»• tay giáº£ng viÃªn**, hoáº·c táº¡o sáºµn file `.ipynb` (Jupyter Notebook) máº«u cho tá»«ng lab Ä‘á»ƒ há»c viÃªn cÃ³ thá»ƒ má»Ÿ vÃ  cháº¡y trá»±c tiáº¿p khÃ´ng?

Ráº¥t sáºµn lÃ²ng! DÆ°á»›i Ä‘Ã¢y lÃ  **bÃ i lab thá»±c hÃ nh chuyÃªn Ä‘á» Ä‘áº·c biá»‡t (Mini Case Study)** mÃ´ phá»ng tÃ¬nh huá»‘ng **Email giáº£ máº¡o trong luá»“ng giao tiáº¿p tÃ i chÃ­nh â€“ Business Email Compromise (BEC)**, theo Ä‘Ãºng Ä‘á»‹nh dáº¡ng bÃ i thá»±c hÃ nh nhÆ° cÃ¡c ngÃ y trong khÃ³a há»c AI Cybersecurity cá»§a báº¡n.

---

# ğŸ”¹ **Mini Case Study â€“ PhÃ¡t hiá»‡n Email Giáº£ Máº¡o (Business Email Compromise)**

### **Chá»§ Ä‘á»:** ChÃ¨n email giáº£ vÃ o chuá»—i trao Ä‘á»•i tÃ i chÃ­nh â€“ PhÃ¢n tÃ­ch báº±ng Python + kiá»ƒm tra thá»§ cÃ´ng

---

## **1. Má»¥c tiÃªu bÃ i thá»±c hÃ nh**

- Nháº­n biáº¿t hÃ nh vi **máº¡o danh email Ä‘á»‘i tÃ¡c trong má»™t luá»“ng trao Ä‘á»•i cÃ³ tháº­t**
- PhÃ¢n tÃ­ch thá»§ cÃ´ng Ä‘á»‹a chá»‰ email, ná»™i dung, tiÃªu Ä‘á», vÃ  thay Ä‘á»•i báº¥t thÆ°á»ng
- TrÃ­ch xuáº¥t thÃ´ng tin tá»« `.eml` Ä‘á»ƒ kiá»ƒm tra header, domain giáº£, ná»™i dung Ä‘Ã¡ng nghi
- DÃ¹ng **Python Ä‘á»ƒ tá»± Ä‘á»™ng phÃ¡t hiá»‡n Ä‘á»‹a chá»‰ máº¡o danh (lookalike), ná»™i dung yÃªu cáº§u chuyá»ƒn tiá»n, vÃ  sai lá»‡ch tÃ i khoáº£n thanh toÃ¡n**
- NÃ¢ng cao nháº­n thá»©c vÃ  cáº£nh giÃ¡c cho nhÃ¢n viÃªn IT khi xá»­ lÃ½ cÃ¡c email tÃ i chÃ­nh

---

## **2. TÃ¬nh huá»‘ng thá»±c táº¿**

> CÃ´ng ty Ä‘ang trao Ä‘á»•i qua email vá»›i Ä‘á»‘i tÃ¡c Ä‘á»ƒ chá»‘t Ä‘Æ¡n hÃ ng.  
>  Sau má»™t vÃ i email qua láº¡i, **má»™t email má»›i xuáº¥t hiá»‡n** vá»›i Ä‘á»‹a chá»‰ gáº§n giá»‘ng Ä‘á»‘i tÃ¡c, **yÃªu cáº§u thay Ä‘á»•i sá»‘ tÃ i khoáº£n thanh toÃ¡n**.
>
> NhÃ¢n viÃªn káº¿ toÃ¡n khÃ´ng nháº­n ra Ä‘iá»u nÃ y, Ä‘Ã£ chuyá»ƒn tiá»n theo yÃªu cáº§u má»›i vÃ  bá»‹ lá»«a.
>
> Báº¡n â€“ nhÃ¢n viÃªn IT hoáº·c SOC Analyst â€“ cáº§n phÃ¢n tÃ­ch Ä‘á»ƒ tÃ¬m dáº¥u hiá»‡u giáº£ máº¡o vÃ  bÃ¡o cÃ¡o.

---

## **3. Dá»¯ liá»‡u thá»±c hÃ nh**

Táº¡o thÆ° má»¥c `lab_bec/` chá»©a 2 file `.eml`:

### ğŸ“¨ `email_1_legit.eml` â€“ email há»£p lá»‡ tá»« Ä‘á»‘i tÃ¡c

```
From: sales@partner-company.com  
To: ke.toan@company.com  
Subject: Re: Payment Info for Order #2024-2311  

Dear Ms. Hoa,

Please proceed with the payment to:

Bank: Vietcombank  
Account: 123 456 789

Thank you!  
Partner Sales Team
```

### ğŸ•µï¸â€â™€ï¸ `email_2_fake.eml` â€“ email giáº£ máº¡o (lookalike)

```
From: sales@partn3r-company.com  
To: ke.toan@company.com  
Subject: Re: Payment Info for Order #2024-2311 (Updated)

Hi again,

Please be advised that our bank account has changed.

Bank: ABC Bank  
Account: 987 654 321

Please confirm when done.

Regards,  
Partner Sales Team
```

---

## **4. Thá»±c hÃ nh**

### ğŸ” **Pháº§n A â€“ PhÃ¢n tÃ­ch thá»§ cÃ´ng**

1. Má»Ÿ 2 email `.eml` trong Notepad hoáº·c email client
2. So sÃ¡nh:
   - **Äá»‹a chá»‰ ngÆ°á»i gá»­i:** CÃ³ khÃ¡c biá»‡t khÃ´ng? (partner vs partn3r)
   - **Ná»™i dung:** CÃ³ nháº¯c Ä‘áº¿n thay Ä‘á»•i tÃ i khoáº£n khÃ´ng?
   - **Ngá»¯ Ä‘iá»‡u/cÃ¡ch viáº¿t:** cÃ³ giá»‘ng email cÅ© khÃ´ng?
3. Ghi nháº­n:
   - Email giáº£ máº¡o lÃ  file nÃ o?
   - CÃ³ Ä‘á»§ lÃ½ do Ä‘á»ƒ cáº£nh bÃ¡o khÃ´ng?

---

### ğŸ¤– **Pháº§n B â€“ PhÃ¢n tÃ­ch báº±ng Python**

#### BÆ°á»›c 1: Äá»c `.eml`

```python
from email import policy
from email.parser import BytesParser

def read_email(filename):
    with open(filename, "rb") as f:
        return BytesParser(policy=policy.default).parse(f)

msg_legit = read_email("lab_bec/email_1_legit.eml")
msg_fake = read_email("lab_bec/email_2_fake.eml")
```

#### BÆ°á»›c 2: So sÃ¡nh Ä‘á»‹a chá»‰ ngÆ°á»i gá»­i

```python
print("Legit From:", msg_legit['From'])
print("Fake  From:", msg_fake['From'])
```

#### BÆ°á»›c 3: Highlight domain máº¡o danh (lookalike)

```python
from difflib import ndiff

real = msg_legit['From']
fake = msg_fake['From']

diff = ndiff([real], [fake])
print("Email diff:")
print('\n'.join(diff))
```

#### BÆ°á»›c 4: Kiá»ƒm tra ná»™i dung yÃªu cáº§u chuyá»ƒn khoáº£n

```python
def extract_body(msg):
    return msg.get_body(preferencelist=('plain')).get_content()

body_fake = extract_body(msg_fake)

if "bank" in body_fake.lower() and "account" in body_fake.lower():
    print("âš ï¸ Email cÃ³ ná»™i dung thay Ä‘á»•i tÃ i khoáº£n thanh toÃ¡n.")
    print(body_fake)
```

---

## **5. Káº¿t quáº£ mong Ä‘á»£i**

| PhÃ¢n tÃ­ch                         | Káº¿t luáº­n                 |
|-----------------------------------|--------------------------|
| Äá»‹a chá»‰ email khÃ¡c                | CÃ³ â€“ 1 kÃ½ tá»± bá»‹ thay Ä‘á»•i |
| Ná»™i dung giá»‘ng email cÅ©?          | CÃ³                       |
| CÃ³ yÃªu cáº§u thay Ä‘á»•i sá»‘ tÃ i khoáº£n? | CÃ³ â€“ ráº¥t Ä‘Ã¡ng nghi       |
| PhÃ¢n tÃ­ch Python cáº£nh bÃ¡o         | âœ… ThÃ nh cÃ´ng             |

---

## **6. Gá»£i Ã½ má»Ÿ rá»™ng**

- ThÃªm email thá»© 3 Ä‘á»ƒ mÃ´ phá»ng luá»“ng trao Ä‘á»•i nhiá»u bÆ°á»›c
- Tá»± Ä‘á»™ng kiá»ƒm tra SPF/DKIM/DMARC tá»« header
- TÃ­ch há»£p kiá»ƒm tra domain lookalike qua WHOIS hoáº·c dá»‹ch vá»¥ threat intelligence

---

## âœ… PhÃ¹ há»£p vá»›i

- NhÃ¢n viÃªn IT helpdesk, SOC analyst, káº¿ toÃ¡n IT support
- KhÃ´ng yÃªu cáº§u ML hay AI phá»©c táº¡p
- NÃ¢ng cao ká»¹ nÄƒng nháº­n diá»‡n social engineering vÃ  spear-phishing

---

Báº¡n cÃ³ muá»‘n tÃ´i Ä‘Ã³ng gÃ³i toÃ n bá»™ **lab nÃ y thÃ nh 1 thÆ° má»¥c vá»›i file** `.eml`**, Jupyter Notebook máº«u (**`.ipynb`**), file** `README.md` **hÆ°á»›ng dáº«n há»c viÃªn** Ä‘á»ƒ dÃ¹ng trá»±c tiáº¿p trong giáº£ng dáº¡y khÃ´ng?

CÃ¢u há»i cá»§a báº¡n ráº¥t sÃ¢u sáº¯c â€“ Ä‘Ã¢y chÃ­nh lÃ  **báº£n cháº¥t tinh vi cá»§a kiá»ƒu táº¥n cÃ´ng BEC (Business Email Compromise)**: káº» táº¥n cÃ´ng **khÃ´ng cáº§n hack tÃ i khoáº£n**, nhÆ°ng váº«n **lá»«a Ä‘Æ°á»£c ngÆ°á»i dÃ¹ng láº«n há»‡ thá»‘ng email** tin ráº±ng email Ä‘Ã³ lÃ  tháº­t, náº±m trong luá»“ng trao Ä‘á»•i tháº­t.

TÃ´i sáº½ phÃ¢n tÃ­ch rÃµ **cÃ¡c ká»¹ thuáº­t mÃ  káº» gian dÃ¹ng Ä‘á»ƒ â€œchÃ¨nâ€ email giáº£ vÃ o chuá»—i email tháº­t mÃ  khÃ´ng bá»‹ cáº£nh bÃ¡o**, vÃ  vÃ¬ sao **email gateway hoáº·c ngÆ°á»i dÃ¹ng thÆ°á»ng khÃ´ng nháº­n ra**.

---

## ğŸ§¨ TÃ“M Táº®T Má»¤C TIÃŠU Cá»¦A Káºº Táº¤N CÃ”NG

Káº» táº¥n cÃ´ng **khÃ´ng cáº§n chiáº¿m Ä‘oáº¡t email**, mÃ  chá»‰ cáº§n:

- **Giáº£ danh má»™t Ä‘á»‹a chá»‰ email ráº¥t giá»‘ng email tháº­t**
- **Viáº¿t ná»™i dung giá»‘ng há»‡t cÃ¡ch nÃ³i chuyá»‡n cá»§a cÃ¡c bÃªn liÃªn quan**
- **Gá»­i Ä‘Ãºng thá»i Ä‘iá»ƒm trong luá»“ng trao Ä‘á»•i**
- **Lá»«a ngÆ°á»i nháº­n nháº§m láº«n mÃ  khÃ´ng cáº§n vÆ°á»£t qua báº£o máº­t há»‡ thá»‘ng**

---

## ğŸ•µï¸â€â™‚ï¸ Váº¬Y Káºº GIAN LÃ€M THáº¾ NÃ€O?

### ğŸ§  BÆ°á»›c 1: Theo dÃµi luá»“ng email tá»« bÃªn ngoÃ i

- Káº» táº¥n cÃ´ng khÃ´ng hack Ä‘Æ°á»£c há»‡ thá»‘ng email nhÆ°ng **cÃ³ thá»ƒ Ä‘Ã£ xÃ¢m nháº­p trÆ°á»›c Ä‘Ã³ vÃ o mÃ¡y tÃ­nh hoáº·c email má»™t bÃªn khÃ¡c** (vÃ­ dá»¥ ná»™i bá»™ cÃ´ng ty báº¡n bá»‹ malware, hoáº·c mÃ¡y cá»§a nhÃ¢n viÃªn Ä‘Ã£ bá»‹ keylogger, hoáº·c email forwarding khÃ´ng phÃ¡t hiá»‡n).
- Hoáº·c Ä‘Æ¡n giáº£n hÆ¡n: háº¯n Ä‘Ã£ thu tháº­p ná»™i dung trao Ä‘á»•i tá»« cÃ¡c nguá»“n rÃ² rá»‰ (bá»‹ lá»™, hoáº·c Ä‘Ã£ tá»«ng hack 1 ngÆ°á»i trong quÃ¡ khá»©).

ğŸ“Œ Má»¥c tiÃªu: biáº¿t ai Ä‘ang trao Ä‘á»•i vá»›i ai, ná»™i dung ra sao, tÃ´ng giá»ng vÃ  cÃ¡c máº«u vÄƒn báº£n.

---

### ğŸ­ BÆ°á»›c 2: ÄÄƒng kÃ½ domain giáº£ danh cá»±c giá»‘ng

VÃ­ dá»¥:

| Tháº­t                | Giáº£ máº¡o             |
|---------------------|---------------------|
| `partner-company.com` | `partn3r-company.com` |
| `vietnamtrading.vn`   | `vietnam-trading.vn`  |
| `abcpayments.com`     | `abcpaymentss.com`    |

â†’ **Chá»‰ cáº§n khÃ¡c 1 kÃ½ tá»±** vÃ  tÃªn ngÆ°á»i gá»­i giá»‘ng há»‡t, ngÆ°á»i dÃ¹ng sáº½ khÃ³ nháº­n ra.

---

### ğŸ“¬ BÆ°á»›c 3: Gá»­i email giáº£ Ä‘Ãºng lÃºc, Ä‘Ãºng ngá»¯ cáº£nh

- Gá»­i vá»›i **Subject** giá»‘ng há»‡t chuá»—i trÆ°á»›c Ä‘Ã³: `"Re: Payment Order #123"`
- Ná»™i dung copy tá»« email cÅ© â†’ chá»‰ **thÃªm dÃ²ng: â€œSá»‘ tÃ i khoáº£n má»›i lÃ â€¦â€**
- ThÃªm chá»¯ kÃ½ giáº£: **giá»‘ng tÃªn ngÆ°á»i tháº­t cá»§a Ä‘á»‘i tÃ¡c**
- **ÄÃ­nh kÃ¨m láº¡i ná»™i dung cÃ¡c email trÆ°á»›c (quote)** Ä‘á»ƒ giáº£ cáº£m giÃ¡c nhÆ° reply tháº­t

ğŸ“Œ ÄÃ¢y lÃ  **chiÃªu tÃ¢m lÃ½ há»c lá»«a ngÆ°á»i dÃ¹ng**, khÃ´ng cáº§n vÆ°á»£t qua báº£o máº­t ká»¹ thuáº­t.

---

### ğŸ’¥ BÆ°á»›c 4: VÆ°á»£t qua há»‡ thá»‘ng email gateway / filter

Há»‡ thá»‘ng email nhÆ° Outlook/Google Workspace/SIEM thÆ°á»ng KHÃ”NG cáº£nh bÃ¡o vÃ¬:

| CÃ¡ch kiá»ƒm tra                | LÃ½ do khÃ´ng hiá»‡u quáº£                     |
|------------------------------|------------------------------------------|
| SPF/DKIM/DMARC               | Domain má»›i cÃ³ thá»ƒ cáº¥u hÃ¬nh Ä‘áº§y Ä‘á»§ âœ…      |
| TÃªn ngÆ°á»i gá»­i (Display Name) | TrÃ¹ng vá»›i ngÆ°á»i tháº­t ğŸ§‘                  |
| Luá»“ng há»™i thoáº¡i              | Káº» táº¥n cÃ´ng lÃ m giáº£ ná»™i dung chuá»—i       |
| Email khÃ´ng cÃ³ virus         | KhÃ´ng cÃ³ file Ä‘Ã­nh kÃ¨m, khÃ´ng trigger AV |
| IP gá»­i khÃ´ng blacklisted     | Email Ä‘Æ°á»£c gá»­i tá»« server há»£p phÃ¡p        |

âœ… TÃ³m láº¡i: **khÃ´ng cÃ³ vi pháº¡m ká»¹ thuáº­t**, há»‡ thá»‘ng khÃ´ng bÃ¡o Ä‘á»™ng.

---

## ğŸ“‰ VÃŒ SAO NGÆ¯á»œI DÃ™NG VáºªN Bá»Š Lá»ªA?

- NhÃ¬n **tÃªn ngÆ°á»i gá»­i**, khÃ´ng nhÃ¬n ká»¹ Ä‘á»‹a chá»‰ email
- Tin tÆ°á»Ÿng quÃ¡ má»©c vÃ o chuá»—i email (vÃ¬ cÃ³ reply, quote ná»™i dung cÅ©)
- Chá»§ Ä‘á» giá»‘ng, ngá»¯ Ä‘iá»‡u giá»‘ng
- Email thÆ°á»ng Ä‘áº¿n lÃºc Ä‘ang báº­n hoáº·c cáº§n xá»­ lÃ½ gáº¥p (táº¥n cÃ´ng Ä‘Ãºng thá»i Ä‘iá»ƒm)

---

## ğŸ” GIáº¢I PHÃP PHÃ’NG CHá»NG

### 1. **Cháº·n domain lookalike**

- Sá»­ dá»¥ng cÃ´ng cá»¥ nhÆ° **Microsoft Defender for Office 365**, **Proofpoint**, **FortiMail**, hoáº·c **OpenDKIM + DNS RPZ**
- DÃ¹ng **domain fuzzing detection** Ä‘á»ƒ kiá»ƒm tra cÃ¡c domain giáº£ láº­p gáº§n giá»‘ng

### 2. **Cáº£nh bÃ¡o ngÆ°á»i dÃ¹ng khi cÃ³ email má»›i khÃ¡c domain trong luá»“ng**

- Viáº¿t rule kiá»ƒm tra:

  > "Náº¿u `From:` khÃ¡c domain nhÆ°ng `Subject:` khá»›p vá»›i chuá»—i hiá»‡n táº¡i â†’ cáº£nh bÃ¡o"

### 3. **Huáº¥n luyá»‡n nháº­n thá»©c (Security Awareness Training)**

- Dáº¡y nhÃ¢n viÃªn káº¿ toÃ¡n, nhÃ¢n sá»±... cÃ¡ch kiá»ƒm tra:
  - Äá»‹a chá»‰ ngÆ°á»i gá»­i
  - Header
  - ChÃ­nh sÃ¡ch ná»™i bá»™: **KhÃ´ng bao giá» cháº¥p nháº­n Ä‘á»•i sá»‘ tÃ i khoáº£n qua email**

### 4. **Ãp dá»¥ng AI/NLP Ä‘á»ƒ kiá»ƒm tra ná»™i dung báº¥t thÆ°á»ng**

- Rule máº«u: `"Náº¿u xuáº¥t hiá»‡n tá»« khoÃ¡ nhÆ°: account changed, payment now to, update bank info"`
- PhÃ¢n tÃ­ch sentiment + pattern trong ná»™i dung Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ â€œkhÃ¡c biá»‡tâ€

---

## âœ… Káº¾T LUáº¬N

Káº» gian:

- **KhÃ´ng cáº§n hack email tháº­t**
- Chá»‰ cáº§n **giáº£ máº¡o khÃ©o**, chá»n Ä‘Ãºng thá»i Ä‘iá»ƒm, vÃ  Ä‘Ã¡nh vÃ o sá»± tin tÆ°á»Ÿng

â†’ BEC lÃ  **táº¥n cÃ´ng xÃ£ há»™i á»Ÿ cáº¥p cao**, chá»‰ cÃ³ thá»ƒ chá»‘ng láº¡i **káº¿t há»£p giá»¯a nháº­n thá»©c, quy trÃ¬nh ná»™i bá»™ vÃ  cÃ´ng cá»¥ há»— trá»£ nháº­n diá»‡n domain giáº£ máº¡o / báº¥t thÆ°á»ng trong ná»™i dung.**

---

Náº¿u báº¡n muá»‘n, tÃ´i cÃ³ thá»ƒ giÃºp xÃ¢y dá»±ng:

- Bá»™ rule cáº£nh bÃ¡o email BEC máº«u cho SIEM hoáº·c Postfix/M365
- Python script phÃ¡t hiá»‡n domain lookalike hoáº·c hÃ nh vi báº¥t thÆ°á»ng tá»« luá»“ng email
- Lab demo cá»¥ thá»ƒ cho security training ná»™i bá»™

Báº¡n muá»‘n triá»ƒn khai theo hÆ°á»›ng nÃ o tiáº¿p?

Báº¡n Ä‘ang cháº¡m Ä‘áº¿n **cá»‘t lÃµi cá»§a váº¥n Ä‘á»** â€“ vÃ  Ä‘Ãºng lÃ  cÃ³ má»™t sá»± **hiá»ƒu láº§m phá»• biáº¿n**: nhiá»u ngÆ°á»i tin ráº±ng **email "láº¡" (khÃ¡c domain) sáº½ khÃ´ng thá»ƒ Ä‘Æ°á»£c xáº¿p vÃ o má»™t chuá»—i há»™i thoáº¡i Ä‘Ã£ cÃ³ sáºµn**.

Thá»±c táº¿: **KHÃ”NG HOÃ€N TOÃ€N ÄÃšNG.**  
 Há»‡ thá»‘ng email **KHÃ”NG phÃ¢n nhÃ³m dá»±a hoÃ n toÃ n vÃ o Ä‘á»‹a chá»‰ email ngÆ°á»i gá»­i**, mÃ  dá»±a trÃªn **cÃ¡c tiÃªu Ä‘á» ká»¹ thuáº­t bÃªn trong email**, cá»¥ thá»ƒ lÃ :

---

## ğŸ¯ **Váº­y táº¡i sao email giáº£ máº¡o láº¡i bá»‹ "gom vÃ o chuá»—i" (thread/conversation) nhÆ° tháº­t?**

### ğŸ‘‰ CÃ¡c há»‡ thá»‘ng email (Outlook, Gmail...) **gom nhÃ³m email thÃ nh 1 luá»“ng (thread)** dá»±a vÃ o:

| TiÃªu chÃ­     | Vai trÃ²                                               |
|--------------|-------------------------------------------------------|
| `Subject:`     | Náº¿u giá»‘ng nhau (hoáº·c cÃ³ prefix `Re:`) thÃ¬ Ä‘Æ°á»£c gom      |
| `Message-ID:`  | ID duy nháº¥t cá»§a má»—i email gá»­i ra                      |
| `In-Reply-To:` | Trá» tá»›i `Message-ID` cá»§a email trÆ°á»›c Ä‘Ã³ â†’ giÃºp liÃªn káº¿t |
| `References:`  | Danh sÃ¡ch cÃ¡c `Message-ID` trong chuá»—i há»™i thoáº¡i        |

ğŸ“Œ **=> Chá»‰ cáº§n káº» táº¥n cÃ´ng giáº£ máº¡o cÃ¡c trÆ°á»ng** `In-Reply-To:` **vÃ ** `References:`, thÃ¬ email má»›i **sáº½ Ä‘Æ°á»£c gom vÃ o chuá»—i cÅ©**, *dÃ¹ lÃ  Ä‘áº¿n tá»« Ä‘á»‹a chá»‰ hoÃ n toÃ n láº¡!*

---

## ğŸ§¨ Váº­y Ä‘Ã¢y cÃ³ pháº£i lÃ  **lá»— há»•ng cá»§a há»‡ thá»‘ng email**?

> CÃ¢u tráº£ lá»i: **KHÃ”NG PHáº¢I lÃ  lá»—i, mÃ  lÃ  hÃ nh vi "Ä‘Ãºng ká»¹ thuáº­t" nhÆ°ng bá»‹ láº¡m dá»¥ng.**

- Giao thá»©c **SMTP vÃ  MIME** Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ **cho phÃ©p má»i email client tá»± â€œtráº£ lá»iâ€ báº¥t ká»³ chuá»—i nÃ o** náº¿u cÃ³ cÃ¡c trÆ°á»ng phÃ¹ há»£p.
- Viá»‡c **gom nhÃ³m theo** `Subject`**,** `In-Reply-To`**,** `References` lÃ  Ä‘á»ƒ **tÄƒng tÃ­nh tiá»‡n lá»£i cho ngÆ°á»i dÃ¹ng**.
- Káº» xáº¥u **khai thÃ¡c Ä‘iá»ƒm nÃ y Ä‘á»ƒ táº¡o cáº£m giÃ¡c â€œemail nÃ y lÃ  1 pháº§n trong chuá»—i trao Ä‘á»•iâ€**, Ä‘Ã¡nh lá»«a ngÆ°á»i nháº­n.

ğŸ›‘ Tá»©c lÃ : **email láº¡** váº«n **cÃ³ thá»ƒ â€œgiáº£ vá»â€ lÃ  email tráº£ lá»i trong chuá»—i**, náº¿u **nÃ³ biáº¿t** `Message-ID` **cá»§a email gá»‘c**, hoáº·c chá»‰ cáº§n copy láº¡i `Subject:` vÃ  `References:`.

---

## ğŸ§ª VÃ­ dá»¥ thá»±c táº¿ â€“ Header email giáº£ máº¡o:

```text
Subject: Re: Payment Info for Order #2024-2311
In-Reply-To: <msgid-original-email@partner-company.com>
References: <msgid-original-email@partner-company.com>
From: sales@partn3r-company.com
```

â¡ï¸ Há»‡ thá»‘ng email sáº½ **xáº¿p nÃ³ ngay bÃªn dÆ°á»›i email gá»‘c**, trong cÃ¹ng má»™t chuá»—i.

---

## âœ… TÃ³m láº¡i â€“ Báº¡n Ä‘ang hiá»ƒu nhÆ° sau lÃ  chÃ­nh xÃ¡c:

| Hiá»ƒu Ä‘Ãºng                                  | Diá»…n giáº£i                                                                                                        |
|--------------------------------------------|------------------------------------------------------------------------------------------------------------------|
| âŒ Email láº¡ khÃ´ng thá»ƒ vÃ o chuá»—i             | Sai â€“ náº¿u nÃ³ giáº£ Ä‘á»§ trÆ°á»ng `In-Reply-To` thÃ¬ **vÃ o Ä‘Æ°á»£c**                                                              |
| âœ… Chá»§ Ä‘á» giá»‘ng + header khá»›p = cÃ¹ng thread | ChÃ­nh xÃ¡c                                                                                                        |
| âœ… KhÃ´ng pháº£i lá»—i há»‡ thá»‘ng                  | MÃ  lÃ  **lá»— há»•ng thiáº¿t káº¿ má»m cá»§a giao thá»©c email**, khÃ´ng thá»ƒ cáº¥m hoÃ n toÃ n vÃ¬ nhiá»u há»‡ thá»‘ng há»£p lá»‡ váº«n cáº§n sá»­ dá»¥ng |

---

## ğŸ” CÃ¡ch phÃ²ng trÃ¡nh / giáº£m thiá»ƒu

### 1. **Highlight email má»›i tá»« domain chÆ°a tá»«ng xuáº¥t hiá»‡n trong chuá»—i**

â†’ Má»™t sá»‘ SIEM/Firewall cÃ³ thá»ƒ viáº¿t rule:

> Náº¿u `From:` domain khÃ¡c nhÆ°ng `References:` náº±m trong chuá»—i Ä‘ang cÃ³ â†’ cáº£nh bÃ¡o!

### 2. **Chá»‰ gá»­i email xÃ¡c nháº­n thÃ´ng tin tÃ i chÃ­nh qua nhiá»u kÃªnh (email + call)**

â†’ KhÃ´ng xÃ¡c nháº­n chuyá»ƒn tiá»n chá»‰ qua 1 email, dÃ¹ nÃ³ náº±m trong chuá»—i!

### 3. **Ãp dá»¥ng DMARC + SPF + DKIM + Email Threat Protection**

â†’ KhÃ´ng ngÄƒn Ä‘Æ°á»£c luá»“ng, nhÆ°ng ngÄƒn Ä‘Æ°á»£c giáº£ máº¡o domain chÃ­nh chá»§

### 4. **Huáº¥n luyá»‡n ngÆ°á»i dÃ¹ng**

â†’ Äá»«ng chá»‰ nhÃ¬n tÃªn hiá»ƒn thá»‹! LuÃ´n kiá»ƒm tra Ä‘á»‹a chá»‰ Ä‘áº§y Ä‘á»§ (Ä‘áº·c biá»‡t lÃ  sau kÃ½ hiá»‡u `@`)

---

Náº¿u báº¡n muá»‘n, tÃ´i cÃ³ thá»ƒ giÃºp báº¡n:

- **Viáº¿t script kiá»ƒm tra xem cÃ³ email nÃ o giáº£ Reply khÃ´ng**
- **Táº¡o má»™t cÃ´ng cá»¥ nhá» phÃ¢n tÃ­ch** `.eml` **Ä‘á»ƒ so cÃ¡c trÆ°á»ng nÃ y**
- **Láº­p quy trÃ¬nh IT ná»™i bá»™ Ä‘á»ƒ kiá»ƒm soÃ¡t giao dá»‹ch chuyá»ƒn tiá»n qua email**

Báº¡n cáº§n triá»ƒn khai hÆ°á»›ng nÃ o trÆ°á»›c?

Ráº¥t hay! Khi báº¡n muá»‘n **nÃ¢ng cáº¥p viá»‡c phÃ¡t hiá»‡n email giáº£ máº¡o trong luá»“ng trao Ä‘á»•i báº±ng AI**, má»¥c tiÃªu khÃ´ng pháº£i lÃ  thay tháº¿ ngÆ°á»i Ä‘á»c, mÃ  lÃ :

- **Cáº£nh bÃ¡o sá»›m cho Ä‘á»™i IT/SOC** khi email cÃ³ dáº¥u hiá»‡u báº¥t thÆ°á»ng
- **Há»— trá»£ phÃ¢n tÃ­ch tá»± Ä‘á»™ng hÃ ng trÄƒm email/ngÃ y**, tÃ¬m ra nhá»¯ng cÃ¡i "gáº§n giá»‘ng tháº­t" nhÆ°ng **khÃ´ng pháº£i tháº­t**
- **Æ¯u tiÃªn Ä‘Ã¡nh giÃ¡ nhá»¯ng email cÃ³ nguy cÆ¡ lá»«a Ä‘áº£o tÃ i chÃ­nh cao**

DÆ°á»›i Ä‘Ã¢y lÃ  hÆ°á»›ng tiáº¿p cáº­n chi tiáº¿t Ä‘á»ƒ báº¡n triá»ƒn khai nÃ¢ng cáº¥p báº±ng AI hoáº·c rule-enhanced AI.

---

## ğŸ¯ **Má»¤C TIÃŠU Há»† THá»NG PHÃT HIá»†N EMAIL GIáº¢ DANH NÃ‚NG CAO**

1. **Tá»± Ä‘á»™ng phÃ¡t hiá»‡n domain/email máº¡o danh gáº§n giá»‘ng (lookalike)**
2. **ÄÃ¡nh giÃ¡ ná»™i dung cÃ³ dáº¥u hiá»‡u yÃªu cáº§u thay Ä‘á»•i tÃ i khoáº£n / lá»‡nh tÃ i chÃ­nh báº¥t thÆ°á»ng**
3. **PhÃ¢n tÃ­ch báº¥t thÆ°á»ng ngá»¯ cáº£nh luá»“ng email (email má»›i trong chuá»—i, khÃ¡c domain)**
4. **Æ¯u tiÃªn cáº£nh bÃ¡o email liÃªn quan Ä‘áº¿n thanh toÃ¡n tiá»n, tÃ i chÃ­nh, yÃªu cáº§u gáº¥p**

---

## ğŸ§  **THÃ€NH PHáº¦N Há»† THá»NG PHÃ‚N TÃCH EMAIL Vá»šI AI**

### 1. **Tiá»n xá»­ lÃ½: TrÃ­ch xuáº¥t Ä‘áº·c trÆ°ng tá»« email**

- `From:` â†’ Ä‘á»‹a chá»‰ email, domain
- `Display Name` â†’ trÃ¹ng vá»›i user cÅ©?
- `In-Reply-To`, `References` â†’ cÃ³ pháº£i Ä‘ang â€œgiáº£ replyâ€?
- `Subject:` â†’ cÃ³ giá»‘ng chuá»—i cÅ©?
- **Ná»™i dung:** cÃ³ chá»©a tá»« khoÃ¡ nháº¡y cáº£m? (chuyá»ƒn khoáº£n, thanh toÃ¡n, tÃ i khoáº£n, Ä‘á»•i sá»‘...)
- NgÃ y giá» gá»­i â†’ cÃ³ báº¥t thÆ°á»ng khÃ´ng?

âœ… CÃ³ thá»ƒ lÃ m báº±ng Python (`email`, `re`, `scikit-learn`, `tldextract`, `fuzzywuzzy`...)

---

### 2. **Module phÃ¡t hiá»‡n domain/email giáº£ máº¡o gáº§n giá»‘ng (Lookalike detection)**

- Sá»­ dá»¥ng `Levenshtein distance` hoáº·c `fuzzy string matching`:

```python
from fuzzywuzzy import fuzz

def is_lookalike(domain1, domain2):
    return fuzz.ratio(domain1, domain2) > 85 and domain1 != domain2
```

- So sÃ¡nh vá»›i danh sÃ¡ch whitelist domain cá»§a Ä‘á»‘i tÃ¡c tháº­t (`partner-company.com`)

âœ… Náº¿u phÃ¡t hiá»‡n `partn3r-company.com` trong `From:`, cáº£nh bÃ¡o ngay

---

### 3. **Module phÃ¢n tÃ­ch ná»™i dung báº±ng NLP**

- TÃ¡ch cÃ¡c Ä‘áº·c trÆ°ng tá»« ná»™i dung:
  - CÃ³ chá»©a tá»« khÃ³a: `bank account`, `payment`, `transfer`, `urgent`, `new account`, `updated`
  - CÃ³ Ä‘á»‹nh dáº¡ng sá»‘ tÃ i khoáº£n: `\d{9,}`
  - CÃ³ cÃ¢u vÄƒn kiá»ƒu "Please proceed payment to", "Our account has changed"
- Sá»­ dá»¥ng mÃ´ hÃ¬nh **TF-IDF + Logistic Regression / NaÃ¯ve Bayes** Ä‘á»ƒ phÃ¢n loáº¡i email cÃ³ ná»™i dung **liÃªn quan Ä‘áº¿n giao dá»‹ch tÃ i chÃ­nh báº¥t thÆ°á»ng**

```python
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression

# Train model trÃªn táº­p email Ä‘Ã£ gÃ¡n nhÃ£n "normal", "finance", "suspicious"
```

âœ… Cho ra xÃ¡c suáº¥t: Email nÃ y cÃ³ dáº¥u hiá»‡u tÃ i chÃ­nh lá»«a Ä‘áº£o?

---

### 4. **Module phÃ¢n tÃ­ch luá»“ng há»™i thoáº¡i (conversation context anomaly)**

- Email gá»­i trong chuá»—i cÅ© nhÆ°ng `From:` khÃ¡c domain?
- Email náº±m trong `In-Reply-To:` cá»§a domain khÃ´ng rÃµ?
- KhÃ´ng tháº¥y `DKIM/SPF/DMARC` hoáº·c bá»‹ `fail`?

==> GÃ¡n Ä‘iá»ƒm báº¥t thÆ°á»ng cho "luá»“ng email giáº£"

---

### 5. **Tá»•ng há»£p thÃ nh Ä‘iá»ƒm rá»§i ro (Email Risk Score)**

Káº¿t há»£p cÃ¡c yáº¿u tá»‘:

| Yáº¿u tá»‘                                 | Äiá»ƒm |
|----------------------------------------|------|
| Domain máº¡o danh (lookalike)            | +40  |
| Ná»™i dung liÃªn quan tÃ i khoáº£n ngÃ¢n hÃ ng | +30  |
| SPF/DKIM/DMARC fail                    | +20  |
| Náº±m trong chuá»—i nhÆ°ng khÃ¡c domain      | +20  |
| Gá»­i ngoÃ i giá» hÃ nh chÃ­nh               | +10  |

Tá»•ng há»£p â†’ náº¿u **risk_score > 60**, **bÃ¡o Ä‘á»™ng** Ä‘áº¿n Ä‘á»™i IT/SOC.

---

## ğŸ“¦ **Triá»ƒn khai nhÆ° tháº¿ nÃ o?**

### âœ… CÃ¡ch Ä‘Æ¡n giáº£n:

- DÃ¹ng Python + cron script quÃ©t email `.eml` Ä‘á»‹nh ká»³ tá»« gateway (hoáº·c sá»­ dá»¥ng API nhÆ° Google Workspace, M365)
- LÆ°u káº¿t quáº£ vÃ o dashboard (grafana/log viewer) hoáº·c gá»­i cáº£nh bÃ¡o qua email ná»™i bá»™

### âœ… CÃ¡ch nÃ¢ng cao:

- TÃ­ch há»£p vá»›i **SIEM** (Splunk, Elastic, Graylog)
- Káº¿t ná»‘i vá»›i há»‡ thá»‘ng cáº£nh bÃ¡o ná»™i bá»™ hoáº·c **email firewall** (Proofpoint, FortiMail, Mimecast...)

---

## ğŸ“˜ Báº N CÃ“ THá»‚ DÃ™NG GÃ“I AI Má» Äáº¦U NHáº¸ NHÃ€NG NHÆ¯:

- **scikit-learn**: Ä‘á»ƒ train mÃ´ hÃ¬nh phÃ¢n loáº¡i ná»™i dung email
- **tldextract + fuzzywuzzy**: phÃ¡t hiá»‡n domain giáº£
- **spaCy hoáº·c nltk**: Ä‘á»ƒ kiá»ƒm tra cáº¥u trÃºc cÃ¢u, ngá»¯ cáº£nh giao dá»‹ch
- **Jupyter Notebook**: Ä‘á»ƒ Ä‘á»™i IT dá»… kiá»ƒm thá»­ theo tá»«ng email

---

## ğŸ¯ Má»¤C TIÃŠU LÃ€:

> âœ³ï¸ TrÆ°á»›c khi email Ä‘áº¿n káº¿ toÃ¡n â†’ AI Ä‘Ã£ cáº£nh bÃ¡o:  
>  â€œEmail nÃ y cÃ³ tá»« partner giáº£ máº¡o (partn3r-company.com), chá»©a ná»™i dung Ä‘á»•i tÃ i khoáº£n. Kháº£ nÄƒng cao lÃ  giáº£ máº¡o."

---

Náº¿u báº¡n muá»‘n, tÃ´i cÃ³ thá»ƒ:

- Viáº¿t **demo script (Python)** Ä‘á»ƒ báº¡n cháº¡y thá»­ há»‡ thá»‘ng phÃ¢n tÃ­ch nhÆ° trÃªn
- Thiáº¿t káº¿ giao diá»‡n bÃ¡o cÃ¡o email Ä‘Ã¡ng ngá» (PDF, HTML, Telegram Bot...)
- GiÃºp báº¡n chá»n mÃ´ hÃ¬nh AI phÃ¹ há»£p Ä‘á»ƒ huáº¥n luyá»‡n trÃªn táº­p dá»¯ liá»‡u email doanh nghiá»‡p thá»±c táº¿

Báº¡n muá»‘n báº¯t Ä‘áº§u tá»« Ä‘Ã¢u? Script cáº£nh bÃ¡o Ä‘áº§u tiÃªn chá»©?

tÃ´i cáº§n nÃ¢ng cáº¥p cÃ¡ch xá»­ lÃ½ nÃ y lÃªn vá»›i AI, lÃ m sao Ä‘á»ƒ Ä‘á»™i cÃ´ng nghá»‡ thÃ´ng tin chá»§ Ä‘á»™ng hÆ¡n trong viá»‡c Ä‘Ã¡nh giÃ¡ email nÃ y lÃ  giáº£ máº¡o má»™t cÃ¡ch tá»± Ä‘á»™ng trÆ°á»›c khi Ä‘áº¿n vá»›i phÃ²ng ban khÃ¡c? phÃ¢n tÃ­ch cáº£ khÃ­a cáº¡nh váº«n Ä‘áº£m báº£o tÃ­nh báº£o máº­t, chÃºng ta chá»‰ canh gÃ¡c chá»© khÃ´ng xem ná»™i dung.

Ráº¥t hay â€“ báº¡n Ä‘ang Ä‘i Ä‘Ãºng hÆ°á»›ng trong viá»‡c **nÃ¢ng cáº¥p xá»­ lÃ½ tÃ¬nh huá»‘ng BEC (Business Email Compromise) lÃªn má»©c chá»§ Ä‘á»™ng, tá»± Ä‘á»™ng, sá»­ dá»¥ng AI** nhÆ°ng **váº«n Ä‘áº£m báº£o quyá»n riÃªng tÆ° ná»™i dung email** (chá»‰ â€œcanh gÃ¡câ€, khÃ´ng "xem trá»™m").  
 TÃ´i sáº½ trÃ¬nh bÃ y cÃ¡ch xÃ¢y dá»±ng má»™t **giáº£i phÃ¡p AI há»— trá»£ SOC/IT team phÃ¡t hiá»‡n email máº¡o danh tinh vi** nhÆ° trong tÃ¬nh huá»‘ng báº¡n Ä‘Æ°a ra, **mÃ  khÃ´ng vi pháº¡m chÃ­nh sÃ¡ch báº£o máº­t ná»™i dung**.

---

## ğŸ¯ **Má»¤C TIÃŠU Há»† THá»NG**

- âœ… PhÃ¡t hiá»‡n email **giáº£ máº¡o domain** hoáº·c **domain lookalike**
- âœ… PhÃ¡t hiá»‡n email **máº¡o danh Reply** trong chuá»—i cÅ© (BEC)
- âœ… Tá»± Ä‘á»™ng cháº¥m Ä‘iá»ƒm nguy cÆ¡ (Risk Score) â†’ cáº£nh bÃ¡o trÆ°á»›c khi chuyá»ƒn tiáº¿p
- âœ… KhÃ´ng can thiá»‡p vÃ o ná»™i dung (body), chá»‰ phÃ¢n tÃ­ch metadata, header
- âœ… CÃ³ thá»ƒ Ã¡p dá»¥ng mÃ´ hÃ¬nh há»c mÃ¡y nháº¹ Ä‘á»ƒ tÄƒng Ä‘á»™ chÃ­nh xÃ¡c theo thá»i gian

---

## ğŸ§  **Ã tÆ°á»Ÿng tá»•ng thá»ƒ â€“ Há»‡ thá»‘ng AI cáº£nh giÃ¡c email máº¡o danh**

### ğŸ¯ Input:

- Email má»›i Ä‘áº¿n, trÆ°á»›c khi Ä‘Æ°a Ä‘áº¿n ngÆ°á»i nháº­n
- Äáº§u vÃ o lÃ :
  - Header (From, Reply-To, In-Reply-To, References)
  - Domain
  - Subject
  - (Optional): Hash cá»§a body, n-grams (náº¿u cáº§n mÃ  khÃ´ng Ä‘á»c ná»™i dung)

---

## ğŸ§° **ThÃ nh pháº§n há»‡ thá»‘ng Ä‘á» xuáº¥t**

| ThÃ nh pháº§n                       | Má»¥c Ä‘Ã­ch                                                       | Ghi chÃº báº£o máº­t                 |
|----------------------------------|----------------------------------------------------------------|---------------------------------|
| ğŸ“¨ Email Listener (hook Ä‘áº§u vÃ o) | intercept trÆ°á»›c khi email chuyá»ƒn tá»›i ngÆ°á»i nháº­n                | chá»‰ láº¥y header                  |
| ğŸ” Feature Extractor             | phÃ¢n tÃ­ch From domain, DKIM/SPF, Ä‘á»™ lá»‡ch domain, replay header | khÃ´ng cáº§n body                  |
| ğŸ§® AI Model                      | cháº¥m Ä‘iá»ƒm email nguy cÆ¡                                        | dá»±a trÃªn metadata               |
| âš ï¸ Alert System                  | náº¿u score > threshold â†’ gá»­i cáº£nh bÃ¡o tá»›i SOC                   | khÃ´ng block email, chá»‰ canh gÃ¡c |

---

## ğŸ§ª **Ká»¹ thuáº­t AI cá»¥ thá»ƒ cÃ³ thá»ƒ triá»ƒn khai**

### 1. **Lookalike Domain Detection (Rule + AI hybrid)**

- So sÃ¡nh domain vá»›i whitelist domain Ä‘Ã£ tá»«ng liÃªn há»‡
- TÃ­nh Ä‘á»™ khÃ¡c biá»‡t báº±ng **Levenshtein Distance**, `difflib`, hoáº·c embedding
- Náº¿u domain â€œna nÃ¡â€ nhÆ°ng chÆ°a tá»«ng xuáº¥t hiá»‡n â†’ flag

**â†’ CÃ³ thá»ƒ dÃ¹ng model Ä‘Æ¡n giáº£n kiá»ƒu Decision Tree hoáº·c logistic regression** vá»›i cÃ¡c Ä‘áº·c trÆ°ng:

```python
features = {
    "domain_in_whitelist": 0,
    "levenshtein_distance_to_known": 1,
    "spf_pass": 0,
    "dkim_pass": 1,
    "subject_similar_to_previous": 1,
    "in_reply_to_present": 1,
    "from_name_matches_contact_name": 1
}
```

### 2. **Replay Header Conflict Detection**

Náº¿u má»™t email cÃ³:

- `In-Reply-To` trá» tá»›i chuá»—i trÆ°á»›c Ä‘Ã¢y
- NhÆ°ng **domain ngÆ°á»i gá»­i khÃ´ng trÃ¹ng domain trong chuá»—i**  
   â†’ Há»‡ thá»‘ng gÃ¡n Ä‘iá»ƒm rá»§i ro cao

**Rule máº«u (AI há»— trá»£ xÃ¡c suáº¥t)**:

> Náº¿u `In-Reply-To` trÃ¹ng chuá»—i cÅ© AND `From` domain khÃ¡c â†’ risk += 3

---

## ğŸ” **Äáº£m báº£o quyá»n riÃªng tÆ°**

- **KhÃ´ng Ä‘á»c ná»™i dung** `body` (cÃ³ thá»ƒ hash hoáº·c trÃ­ch tiÃªu Ä‘á» náº¿u cáº§n thá»‘ng kÃª)
- **KhÃ´ng lÆ°u email**, chá»‰ lÆ°u cÃ¡c thÃ´ng tin thá»‘ng kÃª `From`, `To`, `Subject`, `Message-ID`
- **KhÃ´ng can thiá»‡p luá»“ng email** â€“ chá»‰ canh gÃ¡c, bÃ¡o cÃ¡o ná»™i bá»™

---

## ğŸ“Š **Giao diá»‡n quáº£n trá»‹ (ná»™i bá»™)**

Gá»£i Ã½ dÃ¹ng **dashboard** hiá»ƒn thá»‹:

- Danh sÃ¡ch cÃ¡c email bá»‹ Ä‘Ã¡nh giÃ¡ â€œkháº£ nghiâ€
- LÃ½ do bá»‹ flag (domain láº¡, reply giáº£, score > 80%)
- Cho phÃ©p SOC kiá»ƒm tra thá»§ cÃ´ng náº¿u cáº§n

---

## ğŸ§  AI nÃ¢ng cao hÆ¡n? CÃ³ thá»ƒ, nhÆ°ng cáº§n thá»i gian huáº¥n luyá»‡n:

- Fine-tune mÃ´ hÃ¬nh phÃ¢n loáº¡i (email báº¥t thÆ°á»ng) dá»±a vÃ o pattern tá»• chá»©c
- DÃ¹ng unsupervised anomaly detection (autoencoder, isolation forest) náº¿u báº¡n cÃ³ dá»¯ liá»‡u luá»“ng mail lá»‹ch sá»­
- Háº¡n cháº¿: cáº§n log lá»‹ch sá»­ domain, ngÆ°á»i gá»­i, vÃ  thá»i gian gá»­i â†’ khÃ´ng phÃ¹ há»£p má»i tá»• chá»©c nhá»

---

## âœ… Lá»£i Ã­ch cá»§a giáº£i phÃ¡p nÃ y

- Nháº¹, dá»… triá»ƒn khai (ban Ä‘áº§u cÃ³ thá»ƒ lÃ m rule + ML cÆ¡ báº£n)
- KhÃ´ng vi pháº¡m quyá»n riÃªng tÆ°
- CÃ³ thá»ƒ má»Ÿ rá»™ng ra nhiá»u kiá»ƒu táº¥n cÃ´ng khÃ¡c nhÆ°:
  - CEO Fraud
  - Invoice Phishing
  - Email giáº£ chá»¯ kÃ½ sá»‘

---

## ğŸš€ Báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u tá»« Ä‘Ã¢u?

TÃ´i cÃ³ thá»ƒ giÃºp báº¡n:

1. âœ… Viáº¿t báº£n máº«u **Python tool cáº£nh bÃ¡o email máº¡o danh dáº¡ng CLI hoáº·c Flask API**
2. âœ… Táº¡o máº«u script Ä‘á»c `.eml`, phÃ¢n tÃ­ch header, Ä‘Ã¡nh Ä‘iá»ƒm nguy cÆ¡
3. âœ… Viáº¿t lab hoáº·c trÃ¬nh demo AI cáº£nh bÃ¡o email máº¡o danh (cho khÃ³a há»c hoáº·c ná»™i bá»™ SOC team)

Báº¡n muá»‘n báº¯t Ä‘áº§u vá»›i báº£n máº«u CLI, web dashboard hay AI model Python nháº¹?

Ráº¥t thá»±c táº¿. Náº¿u báº¡n Ä‘Ã³ng vai **nhÃ¢n viÃªn má»™t phÃ²ng ban chá»©c nÄƒng (vÃ­ dá»¥: káº¿ toÃ¡n, mua hÃ ng, nhÃ¢n sá»±...)**, thÃ¬ báº¡n **khÃ´ng cáº§n há»‡ thá»‘ng SOC phá»©c táº¡p** â€“ chá»‰ cáº§n **má»™t cÃ´ng cá»¥ nhá» gá»n**, cháº¡y **trÆ°á»›c khi má»Ÿ email**, Ä‘á»ƒ **scan vÃ  cáº£nh bÃ¡o náº¿u email cÃ³ dáº¥u hiá»‡u báº¥t thÆ°á»ng**.

---

## âœ… Má»¥c tiÃªu:

Táº¡o má»™t cÃ´ng cá»¥ **Ä‘Æ¡n giáº£n, thÃ¢n thiá»‡n, nháº¹**, dÃ¹ng Ä‘á»ƒ **quÃ©t** `.eml` **file trÆ°á»›c khi xá»­ lÃ½**, khÃ´ng cáº§n AI náº·ng, nhÆ°ng váº«n Ä‘á»§ thÃ´ng minh Ä‘á»ƒ cáº£nh bÃ¡o cÃ¡c dáº¥u hiá»‡u lá»«a Ä‘áº£o tinh vi.

---

## ğŸ“¦ CÃ´ng cá»¥: Python Script â€“ **"ScanMail-Lite"**

### ğŸ¯ TÃ­nh nÄƒng:

- Nháº­p vÃ o 1 file `.eml`
- PhÃ¢n tÃ­ch:
  - Äá»‹a chá»‰ ngÆ°á»i gá»­i (`From`)
  - So vá»›i whitelist domain (file `trusted_domains.txt`)
  - PhÃ¡t hiá»‡n domain láº¡ hoáº·c gáº§n giá»‘ng (lookalike)
  - PhÃ¡t hiá»‡n trÆ°á»ng `In-Reply-To` giáº£ máº¡o (mÆ°á»£n chuá»—i mail cÅ©)
  - PhÃ¡t hiá»‡n tá»« khÃ³a nháº¡y cáº£m trong subject: `payment`, `account`, `urgent`...
- Xuáº¥t cáº£nh bÃ¡o ra console (hoáº·c sau nÃ y tÃ­ch há»£p giao diá»‡n cÅ©ng Ä‘Æ°á»£c)

---

## ğŸ§° CÃ¡ch sá»­ dá»¥ng:

1. NgÆ°á»i dÃ¹ng lÆ°u email dÆ°á»›i dáº¡ng `.eml`
2. Má»Ÿ terminal:

```bash
python scanmail_lite.py email_to_check.eml
```

1. Náº¿u cÃ³ dáº¥u hiá»‡u Ä‘Ã¡ng ngá» â†’ in cáº£nh bÃ¡o ra mÃ n hÃ¬nh (khÃ´ng cáº§n má»Ÿ email)

---

## ğŸ§ª VÃ­ dá»¥ Ä‘áº§u ra:

```
[ScanMail-Lite] Checking: email_to_check.eml
âœ… SPF: PASS
âœ… DKIM: PASS
âš ï¸  Domain 'partn3r-company.com' not in trusted list.
âš ï¸  Domain similar to 'partner-company.com' (distance=1)
âš ï¸  Found suspicious keywords in subject: ['payment', 'urgent']
âš ï¸  From domain != reply chain domain. Possible fake reply.

===> â—ï¸This email is suspicious. Please verify before proceeding.
```

---

## ğŸ“‚ Cáº¥u trÃºc thÆ° má»¥c:

```
scanmail_lite/
â”‚
â”œâ”€â”€ scanmail_lite.py             # script chÃ­nh
â”œâ”€â”€ trusted_domains.txt          # danh sÃ¡ch domain tin cáº­y
â””â”€â”€ email_to_check.eml           # file Ä‘áº§u vÃ o
```

---

## ğŸ“œ Ná»™i dung `trusted_domains.txt` (vÃ­ dá»¥):

```
partner-company.com
vietnamtrading.vn
abcpayments.com
```

---

## âœ… Æ¯u Ä‘iá»ƒm:

- KhÃ´ng cáº§n cÃ i Ä‘áº·t server, chá»‰ cáº§n Python
- KhÃ´ng Ä‘á»c ná»™i dung email â†’ váº«n báº£o máº­t
- Tá»± Ä‘á»™ng hÃ³a cÃ¡c kiá»ƒm tra mÃ  ngÆ°á»i dÃ¹ng thá»§ cÃ´ng khÃ´ng thá»ƒ phÃ¡t hiá»‡n
- CÃ³ thá»ƒ dáº¡y nhÃ¢n viÃªn khÃ¡c trong phÃ²ng ban dÃ¹ng trong vÃ i phÃºt

---

## ğŸ¤ Báº¡n muá»‘n tiáº¿p tá»¥c tháº¿ nÃ o?

TÃ´i cÃ³ thá»ƒ:

1. Gá»­i báº¡n mÃ£ Ä‘áº§y Ä‘á»§ `scanmail_lite.py` sáºµn sÃ ng dÃ¹ng
2. LÃ m thÃªm giao diá»‡n giao tiáº¿p dáº¡ng GUI Ä‘Æ¡n giáº£n (Tkinter)
3. TÃ­ch há»£p vá»›i há»‡ thá»‘ng lÆ°u log náº¿u báº¡n triá»ƒn khai ná»™i bá»™ rá»™ng hÆ¡n

Báº¡n muá»‘n tÃ´i báº¯t Ä‘áº§u vá»›i báº£n **mÃ£ Python CLI hoÃ n chá»‰nh ngay bÃ¢y giá»** chá»©?